
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.min.css">



    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://www.safjan.com/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/styles/custom.css">

    <link href="https://www.safjan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Krystian Safjan's Blog Atom">

    <link href="https://www.safjan.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Krystian Safjan's Blog RSS">


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117080232-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117080232-1');
</script>
<!-- End of Google tag (gtag.js) -->



<meta name="author" content="Krystian Safjan" />
<meta name="description" content="Instruction on how to install Photoprism on QNAP NAS using Docker Compose" />
<meta name="keywords" content="nas, photoprism, Linux, photo-gallery, docker, docker-compose, qnap">
<meta expr:content="2022-08-08 00:00:00+02:00" itemprop='datePublished'/>
<meta expr:content="2022-08-08 00:00:00+02:00" itemprop='dateModified'/>
<meta property="article:modified_time" content="2022-08-08 00:00:00+02:00"/>
<meta property="article:published_time" content="2022-08-08 00:00:00+02:00"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Install Photoprism on QNAP NAS using Docker Compose",
  "datePublished": "2022-08-08 00:00:00+02:00",
  "dateModified": "2022-08-08 00:00:00+02:00"
}
</script>



  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Install Photoprism on QNAP NAS using Docker Compose"/>
  <meta property="og:description" content="Instruction on how to install Photoprism on QNAP NAS using Docker Compose"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/install-photoprism-on-qnap-nas-using-docker-compose/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2022-08-08 00:00:00+02:00"/>
  <meta property="article:modified_time" content="2022-08-08 00:00:00+02:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/">
  <meta property="article:section" content="note"/>
  <meta property="article:tag" content="nas"/>
  <meta property="article:tag" content="photoprism"/>
  <meta property="article:tag" content="Linux"/>
  <meta property="article:tag" content="photo-gallery"/>
  <meta property="article:tag" content="docker"/>
  <meta property="article:tag" content="docker-compose"/>
  <meta property="article:tag" content="qnap"/>
  <meta property="og:image" content="/images/profile_new.jpg">

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="https://www.safjan.com/"/>
    <meta name="twitter:label1" content="Est. reading time"/>
    <meta name="twitter:data1" content="4 min."/>
    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:description" content="<p>Instruction on how to install Photoprism on QNAP NAS using Docker Compose</p>"/>
    <meta name="twitter:title" content="Install Photoprism on QNAP NAS using Docker Compose"/>


  <title>Install Photoprism on QNAP NAS using Docker Compose</title>


<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://www.safjan.com/">
        <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
      </a>

      <h1>
        <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
      </h1>

<p>Data Scientist | Researcher | Team Leader<br><br> working at Ernst &amp; Young and writing about <a href="/category/data-science.html">Data Science and Visualization</a>, on <a href="/category/data-science.html">Machine Learning, Deep Learning</a> and <a href="/tag/nlp/">NLP</a>. There are also some  <a href="/category/howto.html">howto</a> posts on tools and workflows.</p>


      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/izikeros" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-envelope" href="mailto:ksafjan@gmail.com" target="_blank">
              <i class="fas fa-envelope"></i>
            </a>
          </li>
          <li>
            <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ" target="_blank">
              <i class="fas fa-graduation-cap"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="/feeds/all.rss.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://www.safjan.com/">Home</a>

      <a href="/archives.html">Articles</a>
      <a href="/til.html">Notes</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

      <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

      <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>
    </nav>

<article class="single">
  <header>
      
    <p>
      <!-- Posted on: -->
      2022-08-08 



  <span id="post-share-links">
    &nbsp;&nbsp;&nbsp;Share on:
    <a href="https://twitter.com/intent/tweet?text=Install%20Photoprism%20on%20QNAP%20NAS%20using%20Docker%20Compose&url=https%3A//www.safjan.com/install-photoprism-on-qnap-nas-using-docker-compose/&hashtags=nas,photoprism,linux,photo-gallery,docker,docker-compose,qnap" target="_blank" title="Share on Twitter">Twitter</a>
    |
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//www.safjan.com/install-photoprism-on-qnap-nas-using-docker-compose/" target="_blank" title="Share on Facebook">Facebook</a>
    |
    <a href="https://news.ycombinator.com/submitlink?t=Install%20Photoprism%20on%20QNAP%20NAS%20using%20Docker%20Compose&u=https%3A//www.safjan.com/install-photoprism-on-qnap-nas-using-docker-compose/" target="_blank" title="Share on HackerNews">HackerNews</a>
    |
    <a href="https://www.reddit.com/submit?url=https%3A//www.safjan.com/install-photoprism-on-qnap-nas-using-docker-compose/&title=Install%20Photoprism%20on%20QNAP%20NAS%20using%20Docker%20Compose" target="_blank" title="Share via Reddit">Reddit</a>
  </span>
    <br/>
   </p>
  <h1 id="install-photoprism-on-qnap-nas-using-docker-compose">Install Photoprism on QNAP NAS using Docker Compose</h1>
  <div class="header-underline"></div>
  </header>


  <div>
    <p>Photoprism is a modern, searchable, well organized web gallery of your photos and videos. At the moment of writing, the official documentation, does not contain a dedicated instructions on  how to install Photoprism on QNAP NAS. This article is meant to fill that gap.
Installation described here was done on TS-251+ (Celeron J1900 4 Cores) but should be applicable to wide variety of other QNAP NAS models.</p>
<!-- MarkdownTOC autolink="true" autoanchor="true" -->

<ul>
<li><a href="#what-is-the-photoprism">What is the photoprism</a></li>
<li><a href="#feature-overview">Feature Overview</a></li>
<li><a href="#installation-on-qnap-nas-from-the-cli">Installation on QNAP NAS from the CLI</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#login-to-your-nas-server-via-ssh">login to your NAS server via SSH</a></li>
<li><a href="#create-photoprism-directory">Create photoprism directory</a></li>
<li><a href="#create-docker-composeyml-file">Create <code>docker-compose.yml</code> file</a></li>
<li><a href="#create-directories-in-sharecontainerphotoprism">Create directories in <code>/share/Container/photoprism</code></a></li>
<li><a href="#run-application-in-the-container">Run application in the container</a><ul>
<li><a href="#using-web-ui">Using web-UI</a></li>
<li><a href="#using-cli">Using CLI</a></li>
</ul>
</li>
<li><a href="#manual-upgrading-photoprism-to-the-latests-version">Manual upgrading Photoprism to the latests version</a></li>
<li><a href="#adding-new-content">Adding new content</a></li>
<li><a href="#performance-tuning">Performance tuning</a></li>
<li><a href="#references">References</a></li>
</ul>
<!-- /MarkdownTOC -->

<p><a id="what-is-the-photoprism"></a></p>
<h2>What is the photoprism</h2>
<p>from the photoprism website:</p>
<blockquote>
<p>PhotoPrism® is an AI-Powered Photos App for the Decentralized Web. It makes use of the latest technologies to tag and find pictures automatically without getting in your way. You can run it at home, on a private server, or in the cloud.</p>
</blockquote>
<p><img alt="Screenshot" src="https://docs.photoprism.app/img/preview.jpg"></p>
<p><a id="feature-overview"></a></p>
<h3>Feature Overview</h3>
<blockquote>
<ul>
<li>Browse <a href="https://docs.photoprism.app/user-guide/organize/browse/">all your photos</a> and <a href="https://try.photoprism.app/videos">videos</a> without worrying about <a href="https://docs.photoprism.app/user-guide/settings/library/">RAW conversion, duplicates or video formats</a></li>
<li>Easily find specific pictures using <a href="https://try.photoprism.app/browse?view=cards&amp;q=flower%20color%3Ared">powerful search filters</a></li>
<li>Recognizes <a href="https://try.photoprism.app/people">the faces of your family and friends</a></li>
<li><a href="https://try.photoprism.app/labels">Automatic classification</a> of pictures based on their content and location</li>
<li><a href="https://try.photoprism.app/browse?view=cards&amp;q=type%3Alive">Play Live Photos</a> by hovering over them in <a href="https://try.photoprism.app/albums">albums</a> and search results</li>
<li>Since the <a href="https://try.photoprism.app/">User Interface</a> is a  <a href="https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps">Progressive Web App</a>, it provides a native app-like experience, and you can conveniently install it on the home screen of all major operating systems and mobile devices</li>
<li>Includes 4 high-resolution <a href="https://try.photoprism.app/places">World Maps</a> to bring back the memories of your favorite trips</li>
<li>Metadata is extracted and merged from Exif, XMP, and other sources such as Google Photos</li>
<li>Many more image properties like <a href="https://try.photoprism.app/browse?view=cards&amp;q=color:red">Colors</a>, <a href="https://try.photoprism.app/browse?view=cards&amp;q=mono%3Atrue">Chroma</a>, and <a href="https://try.photoprism.app/review">Quality</a> can be searched as well</li>
<li>Use  <a href="https://link.photoprism.app/photosync">PhotoSync</a> to securely backup iOS and Android phones in the background</li>
<li>WebDAV clients such as Microsoft's Windows Explorer and Apple's Finder <a href="https://docs.photoprism.app/user-guide/sync/webdav/">can connect directly</a> to PhotoPrism, allowing you to open, edit, and delete files from your computer as if they were local</li>
</ul>
<p><strong>NOTE:</strong> I haven't found functionality to add other accounts than administrator. But in my case having only single user is perfectly fine. </p>
</blockquote>
<p><a id="installation-on-qnap-nas-from-the-cli"></a></p>
<h2>Installation on QNAP NAS from the CLI</h2>
<p><a id="prerequisites"></a></p>
<h3>Prerequisites</h3>
<p>This instruction assumes that you are familiar with using command line interface (CLI).</p>
<ul>
<li>ensure you have installed Container Station which is providing Docker on QNAP NAS</li>
<li>ensure that you have docker in the path</li>
</ul>
<p><a id="login-to-your-nas-server-via-ssh"></a></p>
<h3>login to your NAS server via SSH</h3>
<p>from the terminal or use e.g. <code>putty</code> if working on Windows</p>
<p><a id="create-photoprism-directory"></a></p>
<h3>Create photoprism directory</h3>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>/share/Container/photoprism
<span class="nb">cd</span><span class="w"> </span>photoprism
</code></pre></div>

<p><a id="create-docker-composeyml-file"></a></p>
<h3>Create <code>docker-compose.yml</code> file</h3>
<p>download <code>docker-compose.yml</code> from the link provided in <a href="https://docs.photoprism.app/getting-started/docker-compose/">official documentation</a> :</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://dl.photoprism.app/docker/docker-compose.yml
</code></pre></div>

<p>Assuming that you keep your original photos in <code>/share/Multimedia/photos</code> modify volume mount for <code>photoprism/originals</code>. To do that, edit <code>volumes</code> part of the  <code>docker-compose.yml</code> file you just downloaded and provide proper mapping for the <code>/photoprism/originals</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># &quot;/host/folder:/photoprism/folder&quot;                 # Example</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/share/Multimedia/zdjecia:/photoprism/originals&quot;</span><span class="w"> </span><span class="c1"># Original media files </span>
</code></pre></div>

<blockquote>
<p><strong>NOTE:</strong> Other things you might want to modify in the <code>docker-compose.yml</code> are:
- default password for the user admin (default is: <code>insecure</code>)
- number of workers
- disable Tensorflow (used for categorization of photos and face detection)</p>
<p>For changing number of workers and disabling TensorFlow see the "Performance tuning" section bellow.</p>
</blockquote>
<p><a id="create-directories-in-sharecontainerphotoprism"></a></p>
<h3>Create directories in <code>/share/Container/photoprism</code></h3>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>/share/Container/photoprism/database
mkdir<span class="w"> </span>/share/Container/photoprism/import
mkdir<span class="w"> </span>/share/Container/photoprism/originals
mkdir<span class="w"> </span>/share/Container/photoprism/storage
</code></pre></div>

<p><a id="run-application-in-the-container"></a></p>
<h2>Run application in the container</h2>
<p>Start the container. Pulling images might take few minutes depending on your Internet connection speed.</p>
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>

<p>after that, Photoprism should be available under:</p>
<div class="highlight"><pre><span></span><code>http://&lt;YOUR-NAS-IP&gt;:2342
</code></pre></div>

<p>You need to login as administrator with default password for the first time, after login remember to change that password in settings.
<img alt="img" src="/images/photoprism/photoprism_change_password.png"></p>
<p><a id="using-web-ui"></a></p>
<h4>Using web-UI</h4>
<p>Now, you can trigger indexing your photos and videos using web-UI or from CLI.
<img alt="img" src="/images/photoprism/photoprism_indexing.png"></p>
<p><a id="using-cli"></a></p>
<h4>Using CLI</h4>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-ti<span class="w"> </span>photoprism<span class="w"> </span>photoprism<span class="w"> </span>index
</code></pre></div>

<p><a id="manual-upgrading-photoprism-to-the-latests-version"></a></p>
<h3>Manual upgrading Photoprism to the latests version</h3>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/share/Container/photoprism/
docker<span class="w"> </span>pull<span class="w"> </span>photoprism/photoprism:latest
docker<span class="w"> </span>stop<span class="w"> </span>photoprism
docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>

<p>For automated updates check <a href="https://containrrr.dev/watchtower/">Watchtower</a></p>
<p><a id="adding-new-content"></a></p>
<h2>Adding new content</h2>
<ul>
<li>use upload via webDAV</li>
<li>manually upload new pictures and videos to <code>/share/Multimedia/Import</code> and manually trigger import using CLI:</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>photoprism<span class="w"> </span>photoprism<span class="w"> </span>import
</code></pre></div>

<p>You can also consider automating import by adding <code>import</code> do the cron (e.g. every midnight)</p>
<p><a id="performance-tuning"></a></p>
<h2>Performance tuning</h2>
<p>If you are experiencing performance problems you can reduce number of workers (from documentation):</p>
<blockquote>
<p>Try <a href="https://docs.photoprism.app/getting-started/config-options/#index-workers">reducing the number of workers</a> by setting <code>PHOTOPRISM_WORKERS</code> to a reasonably small value in <code>docker-compose.yml</code>, depending on the CPU performance and number of cores</p>
</blockquote>
<p>or disable TensorFlow:</p>
<blockquote>
<p>As a last measure, you can <a href="https://docs.photoprism.app/getting-started/config-options/#feature-flags">disable the use of TensorFlow</a> for image classification and facial recognition. You ca do it via web-UI settings, cli (<code>--disable-tensorflow</code> option) or set <code>PHOTOPRISM_DISABLE_TENSORFLOW</code> to <code>true</code> in <code>docker-compose.yml</code> and restart container.</p>
</blockquote>
<p><strong>Credits:</strong>
I was able to launch this service thanks to the instructions found on reddit [1] provided by <a href="https://www.reddit.com/user/schol4stiker/">schol4stiker</a>.</p>
<p><a id="references"></a></p>
<h2>References</h2>
<ol>
<li><a href="https://www.reddit.com/r/photoprism/comments/vph4ct/comment/ieobj8w/?utm_source=share&amp;utm_medium=web2x&amp;context=3">instruction from reddit</a></li>
<li><a href="https://www.wundertech.net/how-to-setup-photoprism-on-a-synology-nas">How to Setup PhotoPrism on a Synology NAS in 2022 - WunderTech</a></li>
</ol>
  </div>


  <div class="tag-cloud">
    <p>
      <br/><br/>Tags:&nbsp;
      <a href="https://www.safjan.com/tag/nas/">nas</a>
      <a href="https://www.safjan.com/tag/photoprism/">photoprism</a>
      <a href="https://www.safjan.com/tag/linux/">Linux</a>
      <a href="https://www.safjan.com/tag/photo-gallery/">photo-gallery</a>
      <a href="https://www.safjan.com/tag/docker/">docker</a>
      <a href="https://www.safjan.com/tag/docker-compose/">docker-compose</a>
      <a href="https://www.safjan.com/tag/qnap/">qnap</a>
    </p>
  </div>


  <div class="neighbors">
    <a class="btn float-left" href="https://www.safjan.com/trading-algorithms/" title="Trading algorithms and trading strategies">
      <i class="fa fa-angle-left"></i> Previous Post
    </a>
    <a class="btn float-right" href="https://www.safjan.com/reading-csv-with-obsidian-dataview-dataviewjs/" title="Reading CSV with Obsidian dataview and dataviewjs">
      Next Post <i class="fa fa-angle-right"></i>
    </a>
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://www.safjan.com/self-hosted-private-services/">What are the most popular private services that people decide to self-host?</a></li>
      <li><a href="https://www.safjan.com/bash-determine-if-linux-or-macos/">Bash - determine if script runs on Linux, macOS or other system</a></li>
      <li><a href="https://www.safjan.com/awk/">Awk</a></li>
      <li><a href="https://www.safjan.com/change-character-encoding/">Change the character encoding</a></li>
      <li><a href="https://www.safjan.com/check-text-file-encoding/">Check text file encoding</a></li>
    </ul>
  </div>


</article>

    <footer>
<p>
  &copy; 2023 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Krystian Safjan's Blog ",
  "url" : "https://www.safjan.com",
  "image": "/images/profile_new.jpg",
  "description": ""
}
</script>

</body>
</html>