
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.min.css">

    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://www.safjan.com/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/styles/custom.css">

    <link href="https://www.safjan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Krystian Safjan's Blog Atom">

    <link href="https://www.safjan.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Krystian Safjan's Blog RSS">


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117080232-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117080232-1');
</script>
<!-- End of Google tag (gtag.js) -->



<meta name="author" content="Krystian Safjan" />
<meta name="description" content="" />
<meta name="keywords" content="nim, programming, tsp, genetic-algorithms">
<meta expr:content="2023-01-13 00:00:00+01:00" itemprop='datePublished'/>
<meta expr:content="2023-01-13 00:00:00+01:00" itemprop='dateModified'/>
<meta property="article:modified_time" content="2023-01-13 00:00:00+01:00"/>
<meta property="article:published_time" content="2023-01-13 00:00:00+01:00"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Solve TSP problem using genetic algorithms in NIM",
  "datePublished": "2023-01-13 00:00:00+01:00",
  "dateModified": "2023-01-13 00:00:00+01:00"
}
</script>



  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Solve TSP problem using genetic algorithms in NIM"/>
  <meta property="og:description" content=""/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/drafts/solve-tsp-problem-using-genetic-algorithms-in-nim.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-01-13 00:00:00+01:00"/>
  <meta property="article:modified_time" content="2023-01-13 00:00:00+01:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/">
  <meta property="article:section" content="Howto"/>
  <meta property="article:tag" content="nim"/>
  <meta property="article:tag" content="programming"/>
  <meta property="article:tag" content="tsp"/>
  <meta property="article:tag" content="genetic-algorithms"/>
  <meta property="og:image" content="https://www.safjan.com//images/zsh/inside-work-tree.jpg">

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="https://www.safjan.com//images/zsh/inside-work-tree.jpg"/>
    <meta name="twitter:label1" content="Est. reading time"/>
    <meta name="twitter:data1" content="4 min."/>
    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:description" content=""/>
    <meta name="twitter:title" content="Solve TSP problem using genetic algorithms in NIM"/>


  <title>Solve TSP problem using genetic algorithms in NIM</title>


<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://www.safjan.com/">
        <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
      </a>

      <h1>
        <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
      </h1>

<p>Data Scientist | Researcher | Team Leader<br><br> working at Ernst &amp; Young and writing about <a href="/category/data-science.html">Data Science and Visualization</a>, on <a href="/category/data-science.html">Machine Learning, Deep Learning</a> and <a href="/tag/nlp/">NLP</a>. There are also some  <a href="/category/howto.html">howto</a> posts on tools and workflows.</p>


      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/izikeros" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-envelope" href="mailto:ksafjan@gmail.com" target="_blank">
              <i class="fas fa-envelope"></i>
            </a>
          </li>
          <li>
            <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ" target="_blank">
              <i class="fas fa-graduation-cap"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="/feeds/all.rss.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://www.safjan.com/">Home</a>

      <a href="/archives.html">Articles</a>
      <a href="/til.html">Notes</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

      <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

      <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>
    </nav>

<article class="single">
  <header>
      
    <p>
      <!-- Posted on: -->
      2023-01-13 


    <br/>
   </p>
  <h1 id="solve-tsp-problem-using-genetic-algorithms-in-nim">Solve TSP problem using genetic algorithms in NIM</h1>
  <div class="header-underline"></div>
  </header>


  <div>
    <p>Let's start with the outline of a solution for the Traveling Salesman Problem (TSP) using a genetic algorithm in the NIM programming language. Here is an example:</p>
<ol>
<li>
<p>Define a representation for TSP tours (i.e. a list of cities in order) as a sequence of integers, where each integer represents a city.</p>
</li>
<li>
<p>Create an initial population of TSP tours using a random number generator.</p>
</li>
<li>
<p>Use a fitness function to evaluate the quality of each tour in the population. The fitness function should take into account the total distance traveled by the tour.</p>
</li>
<li>
<p>Use genetic operators such as selection, crossover, and mutation to create a new population of tours.</p>
</li>
<li>
<p>Repeat steps 3 and 4 for a certain number of generations or until a satisfactory solution is found.</p>
</li>
<li>
<p>Return the best tour found as the solution to the TSP.</p>
</li>
</ol>
<p>Here is a basic example of how this could be implemented in NIM:</p>
<p>```nim
import random</p>
<p>type
  Tour = seq[int]</p>
<p>var
  population: seq[Tour]</p>
<p>proc createInitialPopulation(n: int, numCities: int):
  population = newSeq(n)
  for i in 0..&lt;n:
    population[i] = randomPermutation(numCities)</p>
<p>proc evaluateFitness(tour: Tour): float =
  # calculate total distance traveled by tour
  # return as a float
  return distance</p>
<p>proc select(population: seq[Tour]): Tour =
  # implement selection operator (e.g. roulette wheel selection)</p>
<p>proc crossover(a: Tour, b: Tour): Tour =
  # implement crossover operator (e.g. two-point crossover)</p>
<p>proc mutate(tour: Tour):
  # implement mutation operator (e.g. swap mutation)</p>
<p>proc solveTSP(numCities: int, populationSize: int, numGenerations: int):
  createInitialPopulation(populationSize, numCities)
  for i in 0..&lt;numGenerations:
    for tour in population:
      evaluateFitness(tour)
    # sort population by fitness
    for j in 0..&lt;populationSize/2:
      a = select(population)
      b = select(population)
      c = crossover(a, b)
      mutate(c)
      population[j] = c
  # return the best tour in the final population</p>
<p>```</p>
<p>Here is an example implementation of the <code>select</code> procedure using roulette wheel selection in NIM:
```
proc select(population: seq[Tour]): Tour =
  var
    totalFitness, randNum: float
    runningSum: float
    i: int
  totalFitness = 0.0
  for tour in population:
    totalFitness += evaluateFitness(tour)
  randNum = random() * totalFitness
  runningSum = 0.0
  for i in 0..<len(population):
    runningSum += evaluateFitness(population[i])
    if runningSum >= randNum:
      return population[i]</p>
<p>```</p>
<p>This implementation uses the <code>random()</code> function to generate a random number between 0 and 1, and then uses that number to select a tour from the population. The <code>evaluateFitness(tour: Tour)</code> function is used to calculate the fitness of each tour, and the roulette wheel selection is implemented by iterating through the population, adding the fitness of each tour to a running sum, and returning the tour when the running sum exceeds the randomly generated number.</p>
<p>Please note that this is just an example, and that there are many different ways to implement roulette wheel selection. Also in this example I am assuming that evaluateFitness(tour: Tour) returns a value between 0 and 1 as fitness of a tour.</p>
<p>Here is an example implementation of the <code>evaluateFitness</code> procedure in NIM:
```
import math</p>
<p>proc evaluateFitness(tour: Tour): float =
  var
    distance: float
    i: int
  distance = 0.0
  for i in 0..&lt;len(tour)-1:
    city1 = tour[i]
    city2 = tour[i+1]
    distance += euclideanDistance(city1, city2)
  return distance</p>
<p>proc euclideanDistance(city1: int, city2: int): float =
  var
    xd: float
    yd: float
  xd = x[city1] - x[city2]
  yd = y[city1] - y[city2]
  return math.sqrt(xd * xd + yd * yd)</p>
<p>```</p>
<p>In this example, <code>euclideanDistance(city1: int, city2: int)</code> calculates the euclidean distance between two cities using the coordinates of the cities. The <code>evaluateFitness</code> procedure iterates through the tour, calculating the total distance traveled by adding up the euclidean distance between each consecutive city in the tour.</p>
<p>Please note that this is just an example, and that there are many different ways to calculate the distance between cities. Also, this example assumes that the x and y coordinates of each city are stored in arrays <code>x</code> and <code>y</code> respectively and also the tour is a list of integers where each integer represents a city.</p>
<p>```nim
proc crossover(a: Tour, b: Tour): Tour =
  var
    i: int
    r1, r2: int
    offspring: Tour
  r1 = randint(0, len(a)-1)
  r2 = randint(r1, len(a)-1)
  offspring = a[0..r1]
  for i in r1..r2:
    if b[i] notin offspring:
      offspring.add(b[i])
  for i in 0..&lt;len(a):
    if a[i] notin offspring:
      offspring.add(a[i])
  return offspring</p>
<p>proc mutate(tour: Tour):
  var
    i, j: int
    r1, r2: int
  r1 = randint(0, len(tour)-1)
  r2 = randint(0, len(tour)-1)
  tour[r1], tour[r2] = tour[r2], tour[r1]</p>
<p>```</p>
<p>The <code>crossover</code> procedure implements a two-point crossover operator. It takes two tours, <code>a</code> and <code>b</code>, as input and creates an offspring tour by taking the sub-tour from <code>a</code> between two randomly selected points and adding any missing cities from <code>b</code> to the offspring.</p>
<p>The <code>mutate</code> procedure implements a swap mutation operator. It takes a tour as input and randomly selects two positions in the tour and swap the elements at those positions.</p>
<p>Please note that this is just an example, and that there are many different ways to implement crossover and mutation operators. Also, in this example I am using <code>randint(a:int, b:int)</code> function which returns random integer between a and b (inclusive)</p>
<blockquote>
<p>How to visualize convergence of the this algorithm in NIM?</p>
</blockquote>
<p>There are several ways to visualize the convergence of a genetic algorithm in NIM. Here are a few examples:</p>
<ol>
<li>
<p>Plotting the best fitness of the population over time: This can be done by keeping track of the best fitness value at each generation and plotting that data over time.</p>
</li>
<li>
<p>Plotting the average fitness of the population over time: Similar to the best fitness, but instead of keeping track of the best fitness, we keep track of average fitness of the population at each generation.</p>
</li>
<li>
<p>Plotting the standard deviation of the fitness of the population over time: This can give an idea of how much the fitness values are varying within the population.</p>
</li>
<li>
<p>Plotting the distribution of the fitness of the population over time: This can give a visual representation of how the population's fitness is changing over time.</p>
</li>
<li>
<p>Plotting the best solution found at each generation: This can give a visual representation of how the algorithm is approaching an optimal solution</p>
</li>
</ol>
<p>To implement this visualization in NIM, you would need to use a library such as matplotlib, or gnuplot. There are also other libraries which you can use to plot. You would also need to store the best, average, standard deviation and population's fitness values in arrays at each generation and then use the plotting libraries to generate the graph.</p>
<p>Please note that, visualization of convergence is not only important for understanding the behavior of the algorithm but also for debugging and fine-tuning the algorithm.</p>
  </div>


  <div class="tag-cloud">
    <p>
      <br/><br/>Tags:&nbsp;
      <a href="https://www.safjan.com/tag/nim/">nim</a>
      <a href="https://www.safjan.com/tag/programming/">programming</a>
      <a href="https://www.safjan.com/tag/tsp/">tsp</a>
      <a href="https://www.safjan.com/tag/genetic-algorithms/">genetic-algorithms</a>
    </p>
  </div>


  <div class="neighbors">
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://www.safjan.com/vscode-as-nim-ide/">Setup VS Code as NIM IDE</a></li>
    </ul>
  </div>


</article>

    <footer>
<p>
  &copy; 2023 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Krystian Safjan's Blog ",
  "url" : "https://www.safjan.com",
  "image": "/images/profile_new.jpg",
  "description": ""
}
</script>

</body>
</html>