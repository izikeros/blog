
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.min.css">

    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://www.safjan.com/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/styles/custom.css">

    <link href="https://www.safjan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Krystian Safjan's Blog Atom">

    <link href="https://www.safjan.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Krystian Safjan's Blog RSS">


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117080232-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117080232-1');
</script>
<!-- End of Google tag (gtag.js) -->



<meta name="author" content="Krystian Safjan" />
<meta name="description" content="summary" />
<meta name="keywords" content="pandas, python, pandas/schema">
<meta expr:content="2023-01-16 00:00:00+01:00" itemprop='datePublished'/>
<meta expr:content="2023-01-16 00:00:00+01:00" itemprop='dateModified'/>
<meta property="article:modified_time" content="2023-01-16 00:00:00+01:00"/>
<meta property="article:published_time" content="2023-01-16 00:00:00+01:00"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pandas Schema Validation",
  "datePublished": "2023-01-16 00:00:00+01:00",
  "dateModified": "2023-01-16 00:00:00+01:00"
}
</script>



  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Pandas Schema Validation"/>
  <meta property="og:description" content="summary"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/drafts/pandas-schema-validation.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-01-16 00:00:00+01:00"/>
  <meta property="article:modified_time" content="2023-01-16 00:00:00+01:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/">
  <meta property="article:section" content="Data Science"/>
  <meta property="article:tag" content="pandas"/>
  <meta property="article:tag" content="python"/>
  <meta property="article:tag" content="pandas/schema"/>
  <meta property="og:image" content="https://www.safjan.com//images/zsh/inside-work-tree.jpg">

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="https://www.safjan.com//images/zsh/inside-work-tree.jpg"/>
    <meta name="twitter:label1" content="Est. reading time"/>
    <meta name="twitter:data1" content="4 min."/>
    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:description" content="<p>summary</p>"/>
    <meta name="twitter:title" content="Pandas Schema Validation"/>


  <title>Pandas Schema Validation</title>


<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://www.safjan.com/">
        <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
      </a>

      <h1>
        <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
      </h1>

<p>Data Scientist | Researcher | Team Leader<br><br> working at Ernst &amp; Young and writing about <a href="/category/data-science.html">Data Science and Visualization</a>, on <a href="/category/data-science.html">Machine Learning, Deep Learning</a> and <a href="/tag/nlp/">NLP</a>. There are also some  <a href="/category/howto.html">howto</a> posts on tools and workflows.</p>


      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/izikeros" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-envelope" href="mailto:ksafjan@gmail.com" target="_blank">
              <i class="fas fa-envelope"></i>
            </a>
          </li>
          <li>
            <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ" target="_blank">
              <i class="fas fa-graduation-cap"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="/feeds/all.rss.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://www.safjan.com/">Home</a>

      <a href="/archives.html">Articles</a>
      <a href="/til.html">Notes</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

      <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

      <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>
    </nav>

<article class="single">
  <header>
      
    <p>
      <!-- Posted on: -->
      2023-01-16 


    <br/>
   </p>
  <h1 id="pandas-schema-validation">Pandas Schema Validation</h1>
  <div class="header-underline"></div>
  </header>


  <div>
    <p>TODO: validate the text for libraries, validate code snippets, consider adding errors, mention decorators</p>
<h1>Introduction to Pandas Dataframe Schema Validation</h1>
<p>Pandas is a widely used library for data manipulation and analysis in Python. To ensure the data is in the correct format and conforms to certain constraints, schema validation is crucial. This process can be useful in various situations such as when importing data from external sources or before performing further analysis or machine learning tasks.</p>
<p>There are several tools and methods available for schema validation in pandas such as <code>pandas_schema</code>, <code>great_expectations</code>, <code>pandera</code> and <code>data-enforce</code>. <a href="https://pandas-schema.readthedocs.io/">pandas_schema</a> and <a href="https://docs.greatexpectations.io/en/latest/index.html">great_expectations</a>  are widely used libraries for pandas data validation. <a href="https://pandera.readthedocs.io/en/latest/">pandera</a>  and <a href="https://data-enforce.readthedocs.io/en/latest/">data-enforce</a>  are also popular libraries for pandas data validation.</p>
<p>In this article, we will overview the available tools and methods for schema validation in pandas and provide example code snippets and links to further resources. We will also discuss the advantages and disadvantages of each tool and provide recommendations for when to use them.</p>
<h2>Overview of Available Tools and Methods</h2>
<p>The tools and methods discussed below accompanying exemplary code snippets. You can use the following contents of a <code>data.csv</code> that comply with the schema used in this article:
<code>name,age,gender,col1,col2,col3,col4,col5
Alice,25,female,1,2.5,text1,True,2022-01-01
Bob,30,male,2,3.5,text2,False,2022-02-01
Charlie,35,male,3,4.5,text3,True,2022-03-01</code></p>
<p>This file contains a dataframe with 8 columns: name, age, gender, col1, col2, col3, col4 and col5.</p>
<ul>
<li>name and gender are of type object</li>
<li>age is of type int</li>
<li>col1,col2 are of type int and float respectively</li>
<li>col3 is of type object</li>
<li>col4 is of type boolean</li>
<li>col5 is of type datetime</li>
</ul>
<p>This file can be used in the examples above to perform data validation using different libraries and methods.</p>
<p>Here is an example of the contents of a <code>data2.csv</code> file that does not comply with the schema used in the article:</p>
<p><code>name,age,gender,col1,col2,col3,col4,col5
Alice,25,female,1,2.5,text1,True,2022-01-01
Bob,30,male,2,3.5,text2,False,2022-02-01
Charlie,35,male,3,4.5,text3,True,2022-03-01
David,170,male,4,5.5,text4,True,2022-04-01</code></p>
<p>This file contains a dataframe with 8 columns: name, age, gender, col1, col2, col3, col4 and col5.</p>
<ul>
<li>The age of David is 170 which is out of range of the schema defined in the article which is range(0, 150)</li>
<li>This file will not comply with the schema defined in the article and will raise an error when trying to validate it using the code provided in the article</li>
<li>This file can be used to demonstrate the validation process and how it will raise errors for invalid data.</li>
</ul>
<h3>Built-in Attributes</h3>
<p>Pandas provides built-in attributes such as <code>.dtypes</code> and <code>.shape</code> that can be used to check the data types and dimensions of a DataFrame. Here's an example of using these attributes to check that a DataFrame has the expected number of rows and columns, and that the columns have the expected data types:</p>
<p>```python
import pandas as pd</p>
<p>df = pd.read_csv("data.csv")</p>
<h1>Check that the DataFrame has the expected number of rows and columns</h1>
<p>assert df.shape == (100, 5)</p>
<h1>Check that the columns have the expected data types</h1>
<p>assert df.dtypes == {"col1": int, "col2": float, "col3": object, "col4": bool, "col5": datetime}</p>
<p>```</p>
<h3>Pandas Schema</h3>
<p><code>pandas_schema</code> is a library that allows you to specify constraints on a DataFrame and then validate that the DataFrame conforms to those constraints. Here's an example of using the <code>pandas_schema</code> library to define a schema for a DataFrame and then validate that the DataFrame conforms to the schema:</p>
<p>```python
from pandas_schema import Column, Schema
from pandas_schema.validation import LeadingWhitespaceValidation, TrailingWhitespaceValidation, IsDtypeValidation, InListValidation</p>
<p>schema = Schema([
    Column('name', [LeadingWhitespaceValidation(), TrailingWhitespaceValidation()]),
    Column('age', [IsDtypeValidation(int), InListValidation(range(0, 150))]),
    Column('gender', [InListValidation(['male', 'female'])])
])</p>
<p>errors = schema.validate(df)</p>
<p>```</p>
<h3>Great Expectations</h3>
<p><code>great_expectations</code> is a library that allows you to define and validate schemas using a more human-readable syntax. Here's an example of using the <code>great_expectations</code> library to define a schema for a DataFrame and then validate that the DataFrame conforms to the schema:</p>
<p>```python
import great_expectations as ge</p>
<p>df = ge.read_csv("data.csv")</p>
<h1>Define the schema</h1>
<p>schema = {
    "columns": {
        "col1": {"expect_type": "int"},
        "col2": {"expect_type": "float"},
        "col3": {"expect_type": "string"},
        "col4": {"expect_type": "bool"},
        "col5": {"expect_type": "datetime"}
    }
}</p>
<h1>Validate the DataFrame against the schema</h1>
<p>validation_result = df.expect(schema)</p>
<h1>Check for any validation errors</h1>
<p>if validation_result.success:
    print("Data validation successful")
else:
    print("Validation errors:", validation_result.result)</p>
<p>```</p>
<h3>Pandera</h3>
<p><code>pandera</code> is a library that allows you to define and validate schemas using a more human-readable syntax and more functionality. Here's an example of using the <code>pandera</code> library to define a schema for a DataFrame and then validate that the DataFrame conforms to the schema:</p>
<p>```python
import pandera as pa</p>
<p>df = pd.read_csv("data.csv")</p>
<h1>Define the schema</h1>
<p>schema = pa.DataFrameSchema({
    "col1": pa.Column(pa.Int),
    "col2": pa.Column(pa.Float),
    "col3": pa.Column(pa.String),
    "col4": pa.Column(pa.Boolean),
    "col5": pa.Column(pa.Datetime)
})</p>
<h1>Validate the DataFrame against the schema</h1>
<p>schema.validate(df)</p>
<p>```</p>
<h3>Data-enforce</h3>
<p><code>data-enforce</code> is a library that allows you to define and validate schemas using a more human-readable syntax and more functionality. Here's an example of using the <code>data-enforce</code> library to define a schema for a DataFrame and then validate that the DataFrame conforms to the schema:</p>
<p>```python
import data_enforce as de</p>
<p>df = pd.read_csv("data.csv")</p>
<h1>Define the schema</h1>
<p>schema = {
    "col1": de.Integer(),
    "col2": de.Float(),
    "col3": de.String(),
    "col4": de.Boolean(),
    "col5": de.Datetime()
}</p>
<h1>Validate the DataFrame against the schema</h1>
<p>de.enforce(df, schema)
```</p>
<p>These are just a few examples of the tools and methods available for schema validation in pandas. For more information on the topic, you might want to check out these resources:</p>
<ul>
<li><a href="https://towardsdatascience.com/data-validation-with-pandas-a5f8b5b7c5b8">Data validation with pandas</a></li>
<li><a href="https://towardsdatascience.com/pandas-dataframe-schema-validation-with-great_expectations-2c1d1f28c7f8">Pandas DataFrame Schema Validation with great_expectations</a></li>
<li><a href="https://realpython.com/pandas-schema-validation/">Pandas Schema: Validate Data with Less Code</a></li>
<li><a href="https://pandera.readthedocs.io/en/latest/validation.html">Pandera: Dataframe validation</a></li>
<li><a href="https://data-enforce.readthedocs.io/en/latest/dataframe.html">Data-enforce: Dataframe validation</a></li>
</ul>
<h2>Comparison and Discussion</h2>
<p>Each of these tools has its own advantages and disadvantages depending on the specific use case.</p>
<p>The built-in attributes such as <code>.dtypes</code> and <code>.shape</code> may be sufficient for simple validation tasks, but they lack advanced functionality such as custom validation logic and integration with other data pipeline tools.</p>
<p><code>pandas_schema</code> and <code>great_expectations</code> libraries offer more advanced functionality such as custom validation logic and integration with other data pipeline tools, and they have a more human-readable syntax. <code>pandera</code> and <code>data-enforce</code> libraries also offer more advanced functionality than the built-in attributes and they have a more human-readable syntax.</p>
<p>The choice of tool will depend on the complexity of the schema and the specific requirements of the project. If the schema is simple and you only need to check data types and dimensions, the built-in attributes may be sufficient. However, if you need more advanced functionality such as custom validation logic or integration with other data pipeline tools, <code>pandas_schema</code>, <code>great_expectations</code>, <code>pandera</code> or <code>data-enforce</code> libraries are better choices.</p>
<p>Overall, it is recommended to use <code>great_expectations</code> for more complex projects, as it has more functionality and a more human-readable syntax. However, if you're looking for a more lightweight solution <code>pandas_schema</code>, <code>pandera</code> and <code>data-enforce</code> are also good options.</p>
  </div>


  <div class="tag-cloud">
    <p>
      <br/><br/>Tags:&nbsp;
      <a href="https://www.safjan.com/tag/pandas/">pandas</a>
      <a href="https://www.safjan.com/tag/python/">python</a>
      <a href="https://www.safjan.com/tag/pandasschema/">pandas/schema</a>
    </p>
  </div>


  <div class="neighbors">
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://www.safjan.com/pandas-dataframe-validation/">Pandas dataframe schema and data types validation</a></li>
      <li><a href="https://www.safjan.com/allow-arbitrary-types-pandas-in-pydantic/">Allow arbitrary types (such as Pandas Dataframe) in Pydantic</a></li>
      <li><a href="https://www.safjan.com/the-benefits-of-packaging-an-ml-model-as-a-python-pex-file/">The Benefits of Packaging an ML Model as a Python PEX File</a></li>
      <li><a href="https://www.safjan.com/difference-between-numba-jit-and-njit-decorators/">Difference between numba jit and njit decorators</a></li>
      <li><a href="https://www.safjan.com/visual-text-exploration-as-part-of-preprocessing-before-classification/">Visual Text Exploration as Part of Preprocessing Before Classification</a></li>
    </ul>
  </div>


</article>

    <footer>
<p>
  &copy; 2023 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Krystian Safjan's Blog ",
  "url" : "https://www.safjan.com",
  "image": "/images/profile_new.jpg",
  "description": ""
}
</script>

</body>
</html>