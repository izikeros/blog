
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://www.safjan.com/theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://www.safjan.com/styles/custom.css">

    <link href="https://www.safjan.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Krystian Safjan's Blog Atom">

    <link href="https://www.safjan.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Krystian Safjan's Blog RSS">


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117080232-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117080232-1');
</script>
<!-- End of Google tag (gtag.js) -->



<meta name="author" content="Krystian Safjan" />
<meta name="description" content="This post describes challenges with model performance evaluation when working with time-series type of data. Cross-validation is a handy technique that can be used to estimate accuracy of measured model performance scores e.g. by calculating spread of scores for different cross-validation folds. However, for the time-series type of data dedicated types of train-test dataset splits for cross validation needs to be used. This article presents train-tests splits method, inspired by bootstrapping that can be used for efficient model performance estimation." />
<meta name="keywords" content="machine learning, statistics, probability">
<meta expr:content="2021-02-10 00:00:00+01:00" itemprop='datePublished'/>
<meta expr:content="2022-09-01 00:00:00+02:00" itemprop='dateModified'/>
<meta property="article:modified_time" content="2022-09-01 00:00:00+02:00"/>
<meta property="article:published_time" content="2021-02-10 00:00:00+01:00"/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Use bootstraping to evaluate performance of ML model when working on time-series type of data",
  "datePublished": "2021-02-10 00:00:00+01:00",
  "dateModified": "2022-09-01 00:00:00+02:00"
}
</script>



  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Use bootstraping to evaluate performance of ML model when working on time-series type of data"/>
  <meta property="og:description" content="This post describes challenges with model performance evaluation when working with time-series type of data. Cross-validation is a handy technique that can be used to estimate accuracy of measured model performance scores e.g. by calculating spread of scores for different cross-validation folds. However, for the time-series type of data dedicated types of train-test dataset splits for cross validation needs to be used. This article presents train-tests splits method, inspired by bootstrapping that can be used for efficient model performance estimation."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/drafts/bootstrap-for-time-series-model-performance-assessment.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2021-02-10 00:00:00+01:00"/>
  <meta property="article:modified_time" content="2022-09-01 00:00:00+02:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/">
  <meta property="article:section" content="'Data Science'"/>
  <meta property="article:tag" content="machine learning"/>
  <meta property="article:tag" content="statistics"/>
  <meta property="article:tag" content="probability"/>
  <meta property="og:image" content="https://www.safjan.com//images/time_series_dev_set/bootstrap.png">

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="https://www.safjan.com//images/time_series_dev_set/bootstrap.png"/>
    <meta name="twitter:label1" content="Est. reading time"/>
    <meta name="twitter:data1" content="4 min."/>
    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:description" content="<p>This post describes challenges with model performance evaluation when working with time-series type of data. Cross-validation is a handy technique that can be used to estimate accuracy of measured model performance scores e.g. by calculating spread of scores for different cross-validation folds. However, for the time-series type of data dedicated types of train-test dataset splits for cross validation needs to be used. This article presents train-tests splits method, inspired by bootstrapping that can be used for efficient model performance estimation.</p>"/>
    <meta name="twitter:title" content="Use bootstraping to evaluate performance of ML model when working on time-series type of data"/>


  <title>Use bootstraping to evaluate performance of ML model when working on time-series type of data</title>


<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://www.safjan.com/">
        <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
      </a>

      <h1>
        <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
      </h1>

<p>Data Scientist | Researcher | Team Leader<br><br> working at Ernst &amp; Young and writing about <a href="/category/data-science.html">Data Science and Visualization</a>, on <a href="/category/data-science.html">Machine Learning, Deep Learning</a> and <a href="/tag/nlp/">NLP</a>. There are also some  <a href="/category/howto.html">howto</a> posts on tools and workflows.</p>


      <ul class="social">
          <li>
            <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-github" href="https://github.com/izikeros" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-envelope" href="mailto:ksafjan@gmail.com" target="_blank">
              <i class="fas fa-envelope"></i>
            </a>
          </li>
          <li>
            <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ" target="_blank">
              <i class="fas fa-graduation-cap"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="/feeds/all.rss.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="https://www.safjan.com/">Home</a>

      <a href="/archives.html">Articles</a>
      <a href="/til.html">Notes</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

      <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

      <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>
    </nav>

<article class="single">
  <header>
      
    <p>
      <!-- Posted on: -->
      February 10, 2021 


    <br/>
   </p>
  <h1 id="bootstrap-for-time-series-model-performance-assessment">Use bootstraping to evaluate performance of ML model when working on time-series type of data</h1>
  <div class="header-underline"></div>
  </header>


  <div>
    <h2>Prerequisites</h2>
<p>This article focuses on using bootstrapping to time-series data. There are references to other techniques such as cross-validation, k-fold split, bootstrap method that are not explained in details here. Please use material from references if there is need to familiarize with aforementioned methods.</p>
<h2>Introduction</h2>
<h3>Model performance evaluation</h3>
<p>For model performance evaluation we typically use <em>"train"-"test"</em> split or three-fold split with additional <em>"validation"</em> (called also <em>"evaluation"</em> or <em>"dev"</em>) set. To allow utilizing more samples for training or determine quality of performance parameter estimation we use cross-validation.</p>
<p>When applying typical cross-validation splits such as K-Fold to time-series data we can easily introduce bias to our estimation of performance since in case of time series, we would like to evaluate performance on the samples that are newer than those in training set. We try to predict future values (regression) or check classification performance on samples that are comes from future from the perspective of the training dataset. From this article you can get ideas on how to split your time-series data samples in order to measure point statistics such as accuracy and confidence interval for this measurement.</p>
<h3>Bootstrap method for parameter estimation</h3>
<p>Often we use sample from larger population to estimate population parameters. E.g. estimate average height of 18 years old folks in given country. When calculating statistics from sample, we have point estimates - single number that characterize measured property (e.g. accuracy, recall). We have to keep in mind that this number is calculated on the sample. How much this result is dependent on the sample we already taken? How the results will differ if we choose different sample? How can we estimate with given confidence (say 95%) what is the range for real value of measured parameter (in the whole population)? To answer this question statistical method called bootstrap comes with help.</p>
<blockquote>
<p><strong>Bootstrapping</strong> is any test or metric that uses <a href="https://en.wikipedia.org/wiki/Sampling_(statistics)#Replacement_of_selected_units">random sampling with replacement</a>, and falls under the broader class of <a href="https://en.wikipedia.org/wiki/Resampling_(statistics)">resampling</a> methods. Bootstrapping assigns measures of accuracy (bias, variance, <a href="https://en.wikipedia.org/wiki/Confidence_interval">confidence intervals</a>, prediction error, etc.) to sample estimates. (source: <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)">wikipedia</a>)</p>
</blockquote>
<p><img alt="bootstrap method explained visually" src="/images/time_series_dev_set/bootstrap.png"></p>
<p>Original Source: <a href="https://yashuseth.blog/2017/12/02/bootstrapping-a-resampling-method-in-statistics/">yashuseth.blog</a></p>
<h3>Problem with time-series data train-test split</h3>
<p>When working with time-series data choice of samples for training and test set should be performed with care to best reflect trends that we want to model (training set) and have element of unknown if we have regression or classification type of problem.</p>
<p><img alt="time series data example - dow jones index" src="/images/time_series_dev_set/time_series_example.png"></p>
<p>There are few methods to approach this problem:</p>
<ul>
<li>Walk forward time serie split as in scikit-learn: <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html">TimeSeriesSplit</a></li>
<li>Block</li>
<li>ref. medium article</li>
<li>bootstrap-based</li>
</ul>
<h2>cv- superset approach (sklearn)</h2>
<p>With this approach we taking different samples for testing in each train-test set. The weak-point of this approach is that there if very difeerent number of samples taken for the training. These different conditions for the training makes comparability of the resutls from each set questionable.</p>
<p><img alt="time series split from scikit-learn" src="/images/time_series_dev_set/sphx_glr_plot_cv_indices_010.png"></p>
<ul>
<li>see: #  https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html</li>
</ul>
<h2>Blocked cv (moving window)</h2>
<p>The moving window approach addressed issue with different number of training samples identified in case of previous approach, here however, number of training samples in each set is very limited to allow sweeping the dataset timeline with the train-test window.</p>
<p>[TODO generate analogue plot, create notebook for that purpose]
<img alt="moving widow time series split" src="/images/time_series_dev_set/sphx_glr_plot_cv_indices_010.png"></p>
<h3>cv - bootstrap-based</h3>
<p>In this approach we keep test samples following in time the training samples and try to generate different versions of train-test sets for bootstraping.</p>
<p>https://medium.com/@soumyachess1496/cross-validation-in-time-series-566ae4981ce4</p>
<p>https://medium.com/eatpredlove/time-series-cross-validation-a-walk-forward-approach-in-python-8534dd1db51a</p>
<p>https://medium.com/@samuel.monnier/cross-validation-tools-for-time-series-ffa1a5a09bf9</p>
<p><em>Any comments or suggestions? <a href="mailto:ksafjan@gmail.com?subject=Blog+post">Let me know</a>.</em></p>
  </div>


  <div class="tag-cloud">
    <p>
      <br/><br/>Tags:&nbsp;
      <a href="https://www.safjan.com/tag/machine-learning/">machine learning</a>
      <a href="https://www.safjan.com/tag/statistics/">statistics</a>
      <a href="https://www.safjan.com/tag/probability/">probability</a>
    </p>
  </div>


  <div class="neighbors">
  </div>

  <div class="related-posts">
    <h4>You might enjoy</h4>
    <ul class="related-posts">
      <li><a href="https://www.safjan.com/learn-bayesian-methods-in-4-steps-by-reading-and-by-doing/">Learn Bayesian methods in 4 steps - by reading and by doing</a></li>
      <li><a href="https://www.safjan.com/data-science-command-line-tools/">Data Science Command-line Tools</a></li>
      <li><a href="https://www.safjan.com/kaggle-evaluation-metrics-used-for-regression-problems/">Kaggle evaluation metrics used for regression problems</a></li>
      <li><a href="https://www.safjan.com/how-to-install-tensorflow-and-keras-on-windows-10/">How to install TensorFlow and Keras on Windows 10</a></li>
      <li><a href="https://www.safjan.com/darwin-approach-to-traveling-salesman/">Darwin Approach to Traveling Salesman</a></li>
    </ul>
  </div>


</article>

    <footer>
<p>
  &copy; 2022 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Krystian Safjan's Blog ",
  "url" : "https://www.safjan.com",
  "image": "/images/profile_new.jpg",
  "description": ""
}
</script>

</body>
</html>