
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="color-scheme" content="light dark"/>
    <script>
      (function() {
        var theme = localStorage.getItem('theme-preference');
        if (theme === 'dark' || theme === 'light') {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"/>
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap"
              rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/pygments/github.min.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

    <link rel="stylesheet" href="https://www.safjan.com/pagefind/pagefind-ui.css">

        <link rel="stylesheet" type="text/css"
              href="https://www.safjan.com/styles/custom.css">

        <link href="https://www.safjan.com/feeds/all.atom.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/atom+xml" rel="alternate"
              title="Krystian Safjan's Blog Atom">

        <link href="https://www.safjan.com/feeds/all.rss.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/rss+xml" rel="alternate"
              title="Krystian Safjan's Blog RSS">


<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RM2PKDCCYM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RM2PKDCCYM');
</script>
<!-- End of Google tag (gtag.js) -->



    <meta name="author" content="Krystian Safjan"/>
    <meta name="description" content="style: bullet min_depth: 2 max_depth: 6 title: &#34;**Contents**&#34; TL; DR SPLADE is a neural retrieval model which learns query/document sparse expansion via the BERT MLM head and sparse regularization. Sparse representations benefit from several advantages compared to dense approaches: efficient use …"/>
    <meta name="keywords" content="splade, tf-idf, bag-of-words, bert, beir, sparse, text-vectorization">


  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="SPLADE sparse vectors - explaination, properties"/>
  <meta property="og:description" content="style: bullet min_depth: 2 max_depth: 6 title: &#34;**Contents**&#34; TL; DR SPLADE is a neural retrieval model which learns query/document sparse expansion via the BERT MLM head and sparse regularization. Sparse representations benefit from several advantages compared to dense approaches: efficient use …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/splade-sparse-vectors/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-11-10 00:00:00+01:00"/>
  <meta property="article:modified_time" content="2023-12-08 00:00:00+01:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/"/>
  <meta property="article:section" content="note"/>
  <meta property="article:tag" content="splade"/>
  <meta property="article:tag" content="tf-idf"/>
  <meta property="article:tag" content="bag-of-words"/>
  <meta property="article:tag" content="bert"/>
  <meta property="article:tag" content="beir"/>
  <meta property="article:tag" content="sparse"/>
  <meta property="article:tag" content="text-vectorization"/>
  <meta property="og:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:image:alt" content="Krystian Safjan's Blog"/>


    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:creator" content="@izikeros"/>
    <meta name="twitter:title" content="SPLADE sparse vectors - explaination, properties"/>
    <meta name="twitter:description" content="style: bullet min_depth: 2 max_depth: 6 title: "**Contents**" TL; DR SPLADE is a neural retrieval model which learns query/document sparse expansion via the BERT MLM head and sparse..."/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.safjan.com/splade-sparse-vectors/"
  },
  "headline": "SPLADE sparse vectors - explaination, properties",
  "datePublished": "2023-11-10T00:00:00+01:00",
  "dateModified": "2023-12-08T00:00:00+01:00",
  "author": {
    "@type": "Person",
    "name": "Krystian Safjan",
    "url": "https://www.safjan.com/author/krystian-safjan/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Krystian Safjan's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/profile_new.jpg"
    }  },
"image": "/images/profile_new.jpg",  "url": "https://www.safjan.com/splade-sparse-vectors/",
  "description": "style: bullet min_depth: 2 max_depth: 6 title: "**Contents**" TL; DR SPLADE is a neural retrieval model which learns query/document sparse expansion via the..."
}
</script>

    <title>    SPLADE sparse vectors - explaination, properties
</title>



<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body>
<div id="reading-progress" class="reading-progress"></div>
<aside>
    <div>
        <a href="https://www.safjan.com/">
                <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
        </a>

        <h1>
            <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
        </h1>

<p>Data Scientist and Team Leader writing about Machine Learning, MLOps, and Python</p>


        <ul class="social">
                <li>
                    <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan"
                       target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/izikeros"
                       target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-envelope" href="mailto:ksafjan@gmail.com"
                       target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ"
                       target="_blank">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-rss" href="/feeds/all.rss.xml"
                       target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>

<div class="promo-box">
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-image">
        <img src="/images/mlop_interview_book_cover_3D_300px.jpg" alt="MLOps Interview Book Cover">
    </a>
    
    <p class="promo-box-headline">Ace Your MLOps Interview</p>
    
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-cta">
        Get for $2.99
    </a>
    
    <p class="promo-box-features">50 Q&A • PDF/ePUB/mobi</p>
</div>
</aside>
<main>

        <nav>
            <a href="https://www.safjan.com/">Home</a>

                <a href="/archives.html">Articles</a>
                <a href="/til.html">Notes</a>
                <a href="/categories.html">Categories</a>
                <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

                <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

                <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>

            <div id="search" class="nav-search"></div>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </button>
        </nav>

    <article class="single">
        <header>
                
            <p>
                <!-- Posted on: -->
                2023-11-10 


                    <span class="share-icons">
                        <a href="https://twitter.com/intent/tweet?text=SPLADE%20sparse%20vectors%20-%20explaination%2C%20properties&url=https%3A//www.safjan.com/splade-sparse-vectors/&via=izikeros&hashtags=splade,tf-idf,bag-of-words,bert,beir,sparse,text-vectorization" target="_blank" title="Share on Twitter" class="share-icon"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//www.safjan.com/splade-sparse-vectors/" target="_blank" title="Share on Facebook" class="share-icon"><i class="fab fa-facebook"></i></a>
                        <a href="https://news.ycombinator.com/submitlink?t=SPLADE%20sparse%20vectors%20-%20explaination%2C%20properties&u=https%3A//www.safjan.com/splade-sparse-vectors/" target="_blank" title="Share on Hacker News" class="share-icon"><i class="fab fa-hacker-news"></i></a>
                        <a href="https://www.reddit.com/submit?url=https%3A//www.safjan.com/splade-sparse-vectors/&title=SPLADE%20sparse%20vectors%20-%20explaination%2C%20properties" target="_blank" title="Share on Reddit" class="share-icon"><i class="fab fa-reddit"></i></a>
                    </span>
                <br/>
            </p>
            <h1 id="splade-sparse-vectors">SPLADE sparse vectors - explaination, properties</h1>
            <div class="header-underline"></div>



        </header>



        <details class="toc-details" id="toc-container">
            <summary>Table of Contents</summary>
            <nav class="toc" aria-label="Table of Contents">
                <ul class="toc-list"></ul>
            </nav>
        </details>

        <div class="article-content">
            <div class="highlight"><pre><span></span><code><span class="n">style</span><span class="o">:</span><span class="w"> </span><span class="n">bullet</span>
<span class="n">min_depth</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
<span class="n">max_depth</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span>
<span class="n">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;**Contents**&quot;</span>
</code></pre></div>

<h2 id="tl-dr">TL; DR</h2>
<p>SPLADE is a neural retrieval model which learns query/document <strong>sparse</strong> expansion via the BERT MLM head and sparse regularization. Sparse representations benefit from several advantages compared to dense approaches: efficient use of inverted index, explicit lexical match, interpretability... They also seem to be better at generalizing on out-of-domain data (BEIR benchmark).</p>
<h2 id="intro">Intro</h2>
<p>I have learned about SPLADE from the article: <a href="https://www.pinecone.io/learn/splade/">SPLADE for Sparse Vector Search Explained | Pinecone</a>. Here below are the key concepts from the article (LLM summary)</p>
<p>The article discusses the evolution of search and recommendation systems, focusing on the shift from traditional "bag of words" methods to modern vector search. It explains how big tech companies like Google, Netflix, and Amazon use vector search to power their systems.</p>
<p>The traditional <strong>bag of words</strong> methods transform documents into a set of words, populating a sparse "frequency vector". While these methods are <strong>efficient and interpretable</strong>, they are <strong>not perfect</strong> due to their <strong>reliance on exact term matching,</strong> which doesn't align with human nature.</p>
<p><strong>Dense embedding</strong> models offer a solution by allowing search based on <strong>semantic meaning</strong>. However, they require <strong>vast amounts of data for fine-tuning</strong> and don't perform well in niche domains where data is scarce.</p>
<p>The article introduces a solution to these problems: <strong>a merger of sparse and dense retrieval through hybrid search and learnable sparse embeddings</strong>. It focuses on <strong>SPLADE</strong> (Sparse Lexical and Expansion model), a <strong>model that uses a pretrained language model like BERT to enhance sparse vector embedding.</strong></p>
<h2 id="how-it-works">how it works</h2>
<p>The idea behind the <strong>Sp</strong>arse <strong>L</strong>exical <strong>a</strong>n<strong>d</strong> <strong>E</strong>xpansion models is that a pretrained language model like BERT can identify connections between words/sub-words (called <em>word-pieces</em> or “terms” in this article) and use that knowledge to enhance our sparse vector embedding.</p>
<p>This works in two ways, it allows us to weigh the relevance of different terms (something like the will carry less relevance than a less common word like orangutan). And it enables <em>term expansion</em>: the inclusion of alternative but relevant terms beyond those found in the original sequence.</p>
<p><img alt="Term expansion allows us to identify relevant but different terms and use them in the sparse vector retrieval step." src="https://cdn.sanity.io/images/vr8gru94/production/17f0aac1f34b4475121744b672156a611dd8aed6-1029x331.png"></p>
<p>Term expansion allows us to identify relevant but different terms and use them in the sparse vector retrieval step.</p>
<p>The most significant advantage of SPLADE is not necessarily that it can <em>do</em> term expansion but instead that it can <em>learn</em> term expansions. Traditional methods required rule-based term expansion which is time-consuming <em>and</em> fundamentally limited. Whereas SPLADE can use the best language models to learn term expansions and even tweak them based on the sentence context.</p>
<p>The article also discusses the pros and cons of sparse and dense vectors, the concept of two-stage retrieval, and the drawbacks of this approach. It then looks into the workings of SPLADE, explaining how it builds sparse embeddings and how it can be implemented using Hugging Face and PyTorch or the official SPLADE library.</p>
<p>The article concludes by acknowledging the <strong>limitations of SPLADE</strong>, such as its <strong>slower retrieval speed compared to other sparse methods</strong>, and suggests solutions to these problems. It also highlights the potential of mixing both dense and sparse representations using hybrid search indexes to make vector search more accurate and accessible.</p>
<p><a href="https://www.safjan.com/tfidf-with-examples/">TF-IDF with examples</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/naver/splade">GitHub - naver/splade: SPLADE: sparse neural search (SIGIR21, SIGIR22)</a></li>
</ul>
<p>[1] T. Formal, B. Piwowarski, S. Clinchant, <a href="https://arxiv.org/abs/2107.05720">SPLADE: Sparse Lexical and Expansion Model for First Stage Ranking</a> (2021), SIGIR 21</p>
<p>[2] T. Formal, C. Lassance, B. Piwowarski, S. Clinchant, <a href="https://export.arxiv.org/abs/2109.10086">SPLADE v2: Sparse Lexical and Expansion Model for Information Retrieval</a> (2021)</p>
<ul>
<li>https://www.linkedin.com/posts/prithivirajdamodaran_%3F%3F%3F%3F%3F%3F-%3F%3F%3F%3F-%3F%3F%3F%3F%3F%3F%3F%3F-activity-7164581754270400512-Aa87?utm_source=share&amp;utm_medium=member_desktop</li>
</ul>
        </div>


        <div class="article-tags">
            <span class="tags-label">Tags:</span>
                <a href="https://www.safjan.com/tag/splade/" class="article-tag">splade</a>
                <a href="https://www.safjan.com/tag/tf-idf/" class="article-tag">tf-idf</a>
                <a href="https://www.safjan.com/tag/bag-of-words/" class="article-tag">bag-of-words</a>
                <a href="https://www.safjan.com/tag/bert/" class="article-tag">bert</a>
                <a href="https://www.safjan.com/tag/beir/" class="article-tag">beir</a>
                <a href="https://www.safjan.com/tag/sparse/" class="article-tag">sparse</a>
                <a href="https://www.safjan.com/tag/text-vectorization/" class="article-tag">text-vectorization</a>
        </div>





            <div class="related-posts">
                <h4 class="related-posts-title">You might also like</h4>
                <div class="related-posts-grid">
                        <a href="https://www.safjan.com/tfidf-with-examples/" class="related-post-card">
                            <span class="related-post-title">TF-IDF with examples</span>
                            <span class="related-post-date">Nov 10, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/text-vectorization-with-vectorhub-and-sentence-transformers/" class="related-post-card">
                            <span class="related-post-title">Easy Text Vectorization With VectorHub and Sentence Transformers</span>
                            <span class="related-post-date">Jul 04, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/detection-of-texts-generated-by-large-language-models-like-chatgpt/" class="related-post-card">
                            <span class="related-post-title">How to Detect ChatGPT-Generated Text?</span>
                            <span class="related-post-date">Jan 11, 2023</span>
                        </a>
                </div>
            </div>




    </article>

    <footer>
<p>
  &copy; 2026 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>    </footer>
</main>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Krystian Safjan's Blog",
  "url": "https://www.safjan.com",
"image": "/images/profile_new.jpg",  "description": ""
}
</script>


<script src="https://www.safjan.com/pagefind/pagefind-ui.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', function() {
        new PagefindUI({
            element: "#search",
            showSubResults: false,
            showImages: false
        });
    });
</script>

<script src="https://www.safjan.com/theme/js/theme-switcher.js"></script>
</body>
</html>