
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="color-scheme" content="light dark"/>
    <script>
      (function() {
        var theme = localStorage.getItem('theme-preference');
        if (theme === 'dark' || theme === 'light') {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"/>
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap"
              rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/theme/stylesheet/style.css">


    <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/theme/pygments/github.min.css">


    <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/theme/font-awesome/css/solid.css">

    <link rel="stylesheet" href="http://127.0.0.1:8000/pagefind/pagefind-ui.css">

        <link rel="stylesheet" type="text/css"
              href="http://127.0.0.1:8000/styles/custom.css">




    <link rel="apple-touch-icon" sizes="180x180" href="http://127.0.0.1:8000/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="http://127.0.0.1:8000/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="http://127.0.0.1:8000/favicon-16x16.png">
    <link rel="shortcut icon" href="http://127.0.0.1:8000/favicon.ico">
    <link rel="manifest" href="http://127.0.0.1:8000/site.webmanifest">
    <meta name="theme-color" content="#333333">
    <meta name="apple-mobile-web-app-title" content="Krystian Safjan's Blog">





    <meta name="author" content="Krystian Safjan"/>
    <meta name="description" content="SPLADE learns query/document sparse expansion using BERT&#39;s MLM head and sparse regularization, offering efficient use of inverted indices, explicit lexical matches, and interpretability while excelling in generalizing to out-of-domain data."/>
    <meta name="keywords" content="splade, tf-idf, bag-of-words, bert, beir, sparse, text-vectorization">


  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="SPLADE sparse vectors - explaination, properties"/>
  <meta property="og:description" content="SPLADE learns query/document sparse expansion using BERT&#39;s MLM head and sparse regularization, offering efficient use of inverted indices, explicit lexical matches, and interpretability while excelling in generalizing to out-of-domain data."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="http://127.0.0.1:8000/splade-sparse-vectors/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-11-10 00:00:00+01:00"/>
  <meta property="article:modified_time" content="2023-12-08 00:00:00+01:00"/>
  <meta property="article:author" content="http://127.0.0.1:8000/author/krystian-safjan/"/>
  <meta property="article:section" content="note"/>
  <meta property="article:tag" content="splade"/>
  <meta property="article:tag" content="tf-idf"/>
  <meta property="article:tag" content="bag-of-words"/>
  <meta property="article:tag" content="bert"/>
  <meta property="article:tag" content="beir"/>
  <meta property="article:tag" content="sparse"/>
  <meta property="article:tag" content="text-vectorization"/>
  <meta property="og:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:image:alt" content="Krystian Safjan's Blog"/>


    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:creator" content="@izikeros"/>
    <meta name="twitter:title" content="SPLADE sparse vectors - explaination, properties"/>
    <meta name="twitter:description" content="SPLADE learns query/document sparse expansion using BERT&#39;s MLM head and sparse regularization, offering efficient use of inverted indices, explicit lexical matches, and interpretability..."/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://127.0.0.1:8000/splade-sparse-vectors/"
  },
  "headline": "SPLADE sparse vectors - explaination, properties",
  "datePublished": "2023-11-10T00:00:00+01:00",
  "dateModified": "2023-12-08T00:00:00+01:00",
  "author": {
    "@type": "Person",
    "name": "Krystian Safjan",
    "url": "http://127.0.0.1:8000/author/krystian-safjan/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Krystian Safjan's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/profile_new.jpg"
    }  },
"image": "/images/profile_new.jpg",  "url": "http://127.0.0.1:8000/splade-sparse-vectors/",
  "description": "SPLADE learns query/document sparse expansion using BERT's MLM head and sparse regularization, offering efficient use of inverted indices, explicit lexical...",
  "articleSection": "note",
  "inLanguage": "en",
  "keywords": "splade, tf-idf, bag-of-words, bert, beir, sparse, text-vectorization",
  "wordCount": 576,
  "speakable": {
    "@type": "SpeakableSpecification",
    "cssSelector": ["article h1", ".summary", ".tldr", "article \u003e p:first-of-type"]
  }}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "http://127.0.0.1:8000/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "note",
      "item": "http://127.0.0.1:8000/category/note.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "SPLADE sparse vectors - explaination, properties"
    }
  ]
}
</script>



<meta name="ai:summary" content="SPLADE learns query/document sparse expansion using BERT&#39;s MLM head and sparse regularization, offering efficient use of inverted indices, explicit lexical matches, and interpretability while excelling in generalizing to out-of-domain data.">

<meta name="ai:topics" content="splade, tf-idf, bag-of-words, bert, beir, sparse, text-vectorization">



<meta name="ai:word-count" content="576">
<meta name="ai:reading-time" content="2 min">

<meta name="ai:section" content="note">



<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">

    <title>    SPLADE sparse vectors - explaination, properties
</title>



<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body>
<div id="reading-progress" class="reading-progress"></div>
<aside>
    <div>
        <a href="http://127.0.0.1:8000/">
                <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
        </a>

        <h1>
            <a href="http://127.0.0.1:8000/">Krystian Safjan's Blog</a>
        </h1>

<p>Data Scientist | Researcher | Team Leader<br><br> working at Ernst &amp; Young and writing about <a href="/category/machine-learning.html">Data Science and Visualization</a>, on <a href="/category/machine-learning.html">Machine Learning, Deep Learning</a> and <a href="/tag/nlp/">NLP</a>. There are also some <a href="/category/howto.html">howto</a> posts on tools and workflows.</p>


        <ul class="social">
                <li>
                    <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan"
                       target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/izikeros"
                       target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-envelope" href="mailto:ksafjan@gmail.com"
                       target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ"
                       target="_blank">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-rss" href="/feeds/all.rss.xml"
                       target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>

<div class="promo-box">
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-image">
        <img src="/images/mlop_interview_book_cover_3D_300px.jpg" alt="MLOps Interview Book Cover">
    </a>
    
    <p class="promo-box-headline">Ace Your MLOps Interview</p>
    
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-cta">
        Get for $2.99
    </a>
    
    <p class="promo-box-features">50 Q&A • PDF/ePUB/mobi</p>
</div>
</aside>
<main>

        <nav aria-label="Main navigation">
            <a href="http://127.0.0.1:8000/">Home</a>

                <a href="/archives.html">Articles</a>
                <a href="/til.html">Notes</a>
                <a href="/categories.html">Categories</a>
                <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>



            <div id="search" class="nav-search"></div>
            <button type="button" id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </button>
        </nav>

    <article class="single">
        <header>
                
            <p>
                <!-- Posted on: -->
                2023-11-10 


                <br/>
            </p>
            <h1>SPLADE sparse vectors - explaination, properties</h1>
            <div class="header-underline"></div>



        </header>




        <div class="article-content">
            <div class="highlight"><pre><span></span><code><span class="n">style</span><span class="o">:</span><span class="w"> </span><span class="n">bullet</span>
<span class="n">min_depth</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
<span class="n">max_depth</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span>
<span class="n">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;**Contents**&quot;</span>
</code></pre></div>

<h2 id="tl-dr">TL; DR</h2>
<p>SPLADE is a neural retrieval model which learns query/document <strong>sparse</strong> expansion via the BERT MLM head and sparse regularization. Sparse representations benefit from several advantages compared to dense approaches: efficient use of inverted index, explicit lexical match, interpretability... They also seem to be better at generalizing on out-of-domain data (BEIR benchmark).</p>
<h2 id="intro">Intro</h2>
<p>I have learned about SPLADE from the article: <a href="https://www.pinecone.io/learn/splade/">SPLADE for Sparse Vector Search Explained | Pinecone</a>. Here below are the key concepts from the article (LLM summary)</p>
<p>The article discusses the evolution of search and recommendation systems, focusing on the shift from traditional "bag of words" methods to modern vector search. It explains how big tech companies like Google, Netflix, and Amazon use vector search to power their systems.</p>
<p>The traditional <strong>bag of words</strong> methods transform documents into a set of words, populating a sparse "frequency vector". While these methods are <strong>efficient and interpretable</strong>, they are <strong>not perfect</strong> due to their <strong>reliance on exact term matching,</strong> which doesn't align with human nature.</p>
<p><strong>Dense embedding</strong> models offer a solution by allowing search based on <strong>semantic meaning</strong>. However, they require <strong>vast amounts of data for fine-tuning</strong> and don't perform well in niche domains where data is scarce.</p>
<p>The article introduces a solution to these problems: <strong>a merger of sparse and dense retrieval through hybrid search and learnable sparse embeddings</strong>. It focuses on <strong>SPLADE</strong> (Sparse Lexical and Expansion model), a <strong>model that uses a pretrained language model like BERT to enhance sparse vector embedding.</strong></p>
<h2 id="how-it-works">how it works</h2>
<p>The idea behind the <strong>Sp</strong>arse <strong>L</strong>exical <strong>a</strong>n<strong>d</strong> <strong>E</strong>xpansion models is that a pretrained language model like BERT can identify connections between words/sub-words (called <em>word-pieces</em> or “terms” in this article) and use that knowledge to enhance our sparse vector embedding.</p>
<p>This works in two ways, it allows us to weigh the relevance of different terms (something like the will carry less relevance than a less common word like orangutan). And it enables <em>term expansion</em>: the inclusion of alternative but relevant terms beyond those found in the original sequence.</p>
<p><img alt="Term expansion allows us to identify relevant but different terms and use them in the sparse vector retrieval step." src="https://cdn.sanity.io/images/vr8gru94/production/17f0aac1f34b4475121744b672156a611dd8aed6-1029x331.png"></p>
<p>Term expansion allows us to identify relevant but different terms and use them in the sparse vector retrieval step.</p>
<p>The most significant advantage of SPLADE is not necessarily that it can <em>do</em> term expansion but instead that it can <em>learn</em> term expansions. Traditional methods required rule-based term expansion which is time-consuming <em>and</em> fundamentally limited. Whereas SPLADE can use the best language models to learn term expansions and even tweak them based on the sentence context.</p>
<p>The article also discusses the pros and cons of sparse and dense vectors, the concept of two-stage retrieval, and the drawbacks of this approach. It then looks into the workings of SPLADE, explaining how it builds sparse embeddings and how it can be implemented using Hugging Face and PyTorch or the official SPLADE library.</p>
<p>The article concludes by acknowledging the <strong>limitations of SPLADE</strong>, such as its <strong>slower retrieval speed compared to other sparse methods</strong>, and suggests solutions to these problems. It also highlights the potential of mixing both dense and sparse representations using hybrid search indexes to make vector search more accurate and accessible.</p>
<p><a href="http://127.0.0.1:8000/tfidf-with-examples/">TF-IDF with examples</a></p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/naver/splade">GitHub - naver/splade: SPLADE: sparse neural search (SIGIR21, SIGIR22)</a></li>
</ul>
<p>[1] T. Formal, B. Piwowarski, S. Clinchant, <a href="https://arxiv.org/abs/2107.05720">SPLADE: Sparse Lexical and Expansion Model for First Stage Ranking</a> (2021), SIGIR 21</p>
<p>[2] T. Formal, C. Lassance, B. Piwowarski, S. Clinchant, <a href="https://export.arxiv.org/abs/2109.10086">SPLADE v2: Sparse Lexical and Expansion Model for Information Retrieval</a> (2021)</p>
<ul>
<li>https://www.linkedin.com/posts/prithivirajdamodaran_%3F%3F%3F%3F%3F%3F-%3F%3F%3F%3F-%3F%3F%3F%3F%3F%3F%3F%3F-activity-7164581754270400512-Aa87?utm_source=share&amp;utm_medium=member_desktop</li>
</ul>
        </div>


        <div class="article-tags">
            <span class="tags-label">Tags:</span>
                <a href="http://127.0.0.1:8000/tag/splade/" class="article-tag">splade</a>
                <a href="http://127.0.0.1:8000/tag/tf-idf/" class="article-tag">tf-idf</a>
                <a href="http://127.0.0.1:8000/tag/bag-of-words/" class="article-tag">bag-of-words</a>
                <a href="http://127.0.0.1:8000/tag/bert/" class="article-tag">bert</a>
                <a href="http://127.0.0.1:8000/tag/beir/" class="article-tag">beir</a>
                <a href="http://127.0.0.1:8000/tag/sparse/" class="article-tag">sparse</a>
                <a href="http://127.0.0.1:8000/tag/text-vectorization/" class="article-tag">text-vectorization</a>
        </div>











    </article>

    <footer>
<p>
  &copy; 2026 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>    </footer>
</main>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Krystian Safjan's Blog",
  "url": "http://127.0.0.1:8000",
"image": "/images/profile_new.jpg",  "description": ""
}
</script>


<script src="http://127.0.0.1:8000/pagefind/pagefind-ui.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', function() {
        new PagefindUI({
            element: "#search",
            showSubResults: false,
            showImages: false,
            basePath: "http://127.0.0.1:8000/pagefind/"
        });
    });
</script>

<script src="http://127.0.0.1:8000/theme/js/theme-switcher.js"></script>

<style>
.youtube-embed {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%;
    background: #000;
    border-radius: 0.375rem;
    overflow: hidden;
}
.youtube-embed iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
.youtube-embed-wrapper {
    margin-bottom: 1rem;
}
.youtube-embed-info {
    padding: 0.5rem 0.75rem;
    background: var(--color-bg-secondary, #f6f8fa);
    border-radius: 0 0 0.375rem 0.375rem;
    font-size: 0.875rem;
    margin-top: -0.375rem;
}
.youtube-embed-info a {
    text-decoration: none;
    color: inherit;
}
.youtube-embed-info a:hover {
    text-decoration: underline;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('pre > code').forEach(function(code) {
        var text = code.textContent.trim();
        if (!text.match(/^https?:\/\/(www\.)?(youtube\.com|youtu\.be)/)) return;

        var lines = text.split('\n');
        var url = lines[0].trim();
        var match = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/);
        if (!match) return;
        var videoId = match[1];

        var meta = {};
        lines.slice(1).forEach(function(line) {
            var m = line.match(/^(\w+):\s*(.+)$/);
            if (m) meta[m[1].toLowerCase()] = m[2].trim();
        });

        var wrapper = document.createElement('div');
        wrapper.className = 'youtube-embed-wrapper';

        var embed = document.createElement('div');
        embed.className = 'youtube-embed';
        embed.innerHTML = '<iframe src="https://www.youtube-nocookie.com/embed/' + videoId +
            '" allowfullscreen loading="lazy" title="' + (meta.title || 'YouTube video').replace(/"/g, '&quot;') + '"></iframe>';
        wrapper.appendChild(embed);

        if (meta.title || meta.author) {
            var info = document.createElement('div');
            info.className = 'youtube-embed-info';
            var html = meta.title ? '<strong>' + meta.title + '</strong>' : '';
            if (meta.author) {
                html += (meta.title ? ' &bull; ' : '');
                html += meta.authorurl ? '<a href="' + meta.authorurl + '" target="_blank" rel="noopener">' + meta.author + '</a>' : meta.author;
            }
            info.innerHTML = html;
            wrapper.appendChild(info);
        }
        code.closest('pre').replaceWith(wrapper);
    });
});
</script>
</body>
</html>