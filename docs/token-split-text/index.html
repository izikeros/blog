
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="color-scheme" content="light dark"/>
    <script>
      (function() {
        var theme = localStorage.getItem('theme-preference');
        if (theme === 'dark' || theme === 'light') {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"/>
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap"
              rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/pygments/github.min.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">

        <link rel="stylesheet" type="text/css"
              href="https://www.safjan.com/styles/custom.css">

        <link href="https://www.safjan.com/feeds/all.atom.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/atom+xml" rel="alternate"
              title="Krystian Safjan's Blog Atom">

        <link href="https://www.safjan.com/feeds/all.rss.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/rss+xml" rel="alternate"
              title="Krystian Safjan's Blog RSS">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.safjan.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.safjan.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.safjan.com/favicon-16x16.png">
    <link rel="shortcut icon" href="https://www.safjan.com/favicon.ico">
    <link rel="manifest" href="https://www.safjan.com/site.webmanifest">
    <meta name="theme-color" content="#333333">
    <meta name="apple-mobile-web-app-title" content="Krystian Safjan's Blog">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RM2PKDCCYM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RM2PKDCCYM');
</script>
<!-- End of Google tag (gtag.js) -->



    <meta name="author" content="Krystian Safjan"/>
    <meta name="description" content="Learn how to efficiently split text into parts based on token limits using the Tiktoken library and a custom Python module, ensuring meaningful splits without breaking words."/>
    <meta name="keywords" content="tokenization, tiktoken, prompt-chunking, split-text, text-partitioning, openai, gpt-4">


  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Introducing a Python Module for Splitting Text Into Parts Based on Token Limit"/>
  <meta property="og:description" content="Learn how to efficiently split text into parts based on token limits using the Tiktoken library and a custom Python module, ensuring meaningful splits without breaking words."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/token-split-text/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-07-03 00:00:00+02:00"/>
  <meta property="article:modified_time" content="2023-07-12 00:00:00+02:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/"/>
  <meta property="article:section" content="note"/>
  <meta property="article:tag" content="tokenization"/>
  <meta property="article:tag" content="tiktoken"/>
  <meta property="article:tag" content="prompt-chunking"/>
  <meta property="article:tag" content="split-text"/>
  <meta property="article:tag" content="text-partitioning"/>
  <meta property="article:tag" content="openai"/>
  <meta property="article:tag" content="gpt-4"/>
  <meta property="og:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image" content="/images/profile_new.jpg"/>
    <meta name="twitter:image:alt" content="Krystian Safjan's Blog"/>


    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:creator" content="@izikeros"/>
    <meta name="twitter:title" content="Introducing a Python Module for Splitting Text Into Parts Based on Token Limit"/>
    <meta name="twitter:description" content="Learn how to efficiently split text into parts based on token limits using the Tiktoken library and a custom Python module, ensuring meaningful splits without breaking words."/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.safjan.com/token-split-text/"
  },
  "headline": "Introducing a Python Module for Splitting Text Into Parts Based on Token Limit",
  "datePublished": "2023-07-03T00:00:00+02:00",
  "dateModified": "2023-07-12T00:00:00+02:00",
  "author": {
    "@type": "Person",
    "name": "Krystian Safjan",
    "url": "https://www.safjan.com/author/krystian-safjan/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Krystian Safjan's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/profile_new.jpg"
    }  },
"image": "/images/profile_new.jpg",  "url": "https://www.safjan.com/token-split-text/",
  "description": "Learn how to efficiently split text into parts based on token limits using the Tiktoken library and a custom Python module, ensuring meaningful splits...",
  "articleSection": "note",
  "inLanguage": "en",
  "keywords": "tokenization, tiktoken, prompt-chunking, split-text, text-partitioning, openai, gpt-4",
  "wordCount": 735,
  "speakable": {
    "@type": "SpeakableSpecification",
    "cssSelector": ["article h1", ".summary", ".tldr", "article \u003e p:first-of-type"]
  }}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://www.safjan.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "note",
      "item": "https://www.safjan.com/category/note.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Introducing a Python Module for Splitting Text..."
    }
  ]
}
</script>



<meta name="ai:summary" content="Learn how to efficiently split text into parts based on token limits using the Tiktoken library and a custom Python module, ensuring meaningful splits without breaking words.">

<meta name="ai:topics" content="tokenization, tiktoken, prompt-chunking, split-text, text-partitioning, openai, gpt-4">



<meta name="ai:word-count" content="735">
<meta name="ai:reading-time" content="3 min">

<meta name="ai:section" content="note">



<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">

    <title>    Introducing a Python Module for Splitting Text Into Parts Based on Token Limit
</title>



<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body>
<div id="reading-progress" class="reading-progress"></div>
<aside>
    <div>
        <a href="https://www.safjan.com/">
                <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
        </a>

        <h1>
            <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
        </h1>

<p>Data Scientist and Team Leader writing about Machine Learning, MLOps, and Python</p>


        <ul class="social">
                <li>
                    <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan"
                       target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/izikeros"
                       target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-envelope" href="mailto:ksafjan@gmail.com"
                       target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ"
                       target="_blank">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-rss" href="/feeds/all.rss.xml"
                       target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>

<div class="promo-box">
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-image">
        <img src="/images/mlop_interview_book_cover_3D_300px.jpg" alt="MLOps Interview Book Cover">
    </a>
    
    <p class="promo-box-headline">Ace Your MLOps Interview</p>
    
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-cta">
        Get for $2.99
    </a>
    
    <p class="promo-box-features">50 Q&A • PDF/ePUB/mobi</p>
</div>
</aside>
<main>

        <nav aria-label="Main navigation">
            <a href="https://www.safjan.com/">Home</a>

                <a href="/archives.html">Articles</a>
                <a href="/til.html">Notes</a>
                <a href="/categories.html">Categories</a>
                <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

                <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

                <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>

            <div id="search" class="nav-search"></div>
            <button type="button" id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </button>
        </nav>

    <article class="single">
        <header>
                
            <p>
                <!-- Posted on: -->
                2023-07-03 


                <br/>
            </p>
            <h1>Introducing a Python Module for Splitting Text Into Parts Based on Token Limit</h1>
            <div class="header-underline"></div>



        </header>




        <div class="article-content">
            <h2 id="introduction">Introduction</h2>
<p>In the realm of natural language processing and text analysis, it is often necessary to split a large piece of text into smaller parts while ensuring that the split does not break words or disrupt the meaning of the text. This task can be challenging, especially when dealing with the tokenization. However, with the help of the Tiktoken library and a custom Python module, splitting text based on a specified number of tokens can be an easy task.</p>
<h2 id="understanding-the-tiktoken-library">Understanding the Tiktoken Library</h2>
<p>Tiktoken is a powerful Python library for tokenization, which is the process of splitting text into individual tokens such as words or subwords. The library provides various tokenization encodings and functions that enable developers to process text data in a tokenized format. It offers support for different languages and tokenization models, making it a versatile tool for a wide range of text processing tasks. Tiktoken is a fast <a href="https://en.wikipedia.org/wiki/Byte_pair_encoding">BPE</a> tokeniser for use with OpenAI's models.</p>
<h2 id="introducing-the-python-module-split_string_with_limit">Introducing the Python Module: split_string_with_limit</h2>
<p>The provided Python module: <a href="https://gist.github.com/izikeros/17d9c8ab644bd2762acf6b19dd0cea39">split_string_with_limit.py</a> (GitHub Gist), leverages the capabilities of the Tiktoken library to split a string into parts with a specified limit on the number of tokens per part. The module takes three parameters: <code>text</code>, <code>limit</code>, and <code>encoding</code>.</p>
<ul>
<li><code>text</code>: The input string that needs to be split.</li>
<li><code>limit</code>: The maximum number of tokens allowed per part.</li>
<li><code>encoding</code>: The tokenization encoding to be used, which determines how the text is tokenized.</li>
</ul>
<p>The module proceeds as follows:</p>
<ol>
<li>It tokenizes the input text using the specified encoding from Tiktoken.</li>
<li>It creates an empty list, <code>parts</code>, to store the tokenized parts.</li>
<li>It initializes a <code>current_part</code> list and a <code>current_count</code> variable to keep track of the tokens in the current part.</li>
<li>It iterates over each token in the tokenized text.</li>
<li>For each token, it appends it to the <code>current_part</code> list and increments the <code>current_count</code> by 1.</li>
<li>If the <code>current_count</code> exceeds the specified limit, it adds the <code>current_part</code> to the <code>parts</code> list, resets the <code>current_part</code> and <code>current_count</code> to empty values, and continues with the next tokens.</li>
<li>Once all the tokens have been processed, the module checks if there is any remaining <code>current_part</code> and adds it to the <code>parts</code> list.</li>
<li>Finally, it converts each tokenized part back into text format by decoding the individual tokens and joins them together. The resulting text parts are stored in the <code>text_parts</code> list.</li>
<li>The module returns the <code>text_parts</code> list as the output.</li>
</ol>
<h2 id="example-usage">Example Usage</h2>
<p>To demonstrate the usage of the <code>split_string_with_limit</code> module, let's consider an example:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>split_string_with_limit.py<span class="w"> </span>input_file.txt<span class="w"> </span><span class="m">100</span><span class="w"> </span>cl100k_base
</code></pre></div>

<p>In this example, we provide three arguments:</p>
<ol>
<li><code>input_file.txt</code>: The path to the input text file that contains the text to be split.</li>
<li><code>100</code>: The maximum number of tokens allowed per part. You can adjust this value based on your requirements.</li>
<li><code>cl100k_base</code>: The encoding name. This determines how the text will be tokenized. Tiktoken provides various encoding options, and you can experiment with different encodings to achieve the desired results.</li>
</ol>
<p>The module reads the text from the input file, tokenizes it using the specified encoding, and splits it into parts based on the token limit. The resulting text parts are then printed in a JSON format, providing a structured representation of the split text.</p>
<h2 id="approximate-approach">Approximate approach</h2>
<p>While the <code>split_string_with_limit</code> module offers a convenient solution for splitting text based on a token limit, it's worth mentioning alternative algorithms or approaches that can achieve similar results. One of these can be a <strong>Fixed-Length Split</strong>: instead of splitting based on the number of tokens, we could split the text into fixed-length segments based on counting words or characters. One can use <a href="https://platform.openai.com/tokenizer">rule of thumb</a>:</p>
<blockquote>
<p>A helpful rule of thumb is that one token generally corresponds to ~4 characters of text for common English text. This translates to roughly ¾ of a word (so 100 tokens ~= 75 words).</p>
</blockquote>
<p>to have approximate of the split into parts of equal length without doing actual tokenization.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this blog post, we introduced the <code>split_string_with_limit</code> Python module, which leverages the power of the Tiktoken library to split a string into parts based on a specified token limit. We discussed the functionality of the module, its parameters, and how it can be used in practice. Furthermore, we explored alternative algorithms and approaches for splitting text based on the number of tokens. By combining the flexibility of Tiktoken and the convenience of the <code>split_string_with_limit</code> module, developers can efficiently process and analyze text data without compromising on accuracy or readability.</p>
        </div>


        <div class="article-tags">
            <span class="tags-label">Tags:</span>
                <a href="https://www.safjan.com/tag/tokenization/" class="article-tag">tokenization</a>
                <a href="https://www.safjan.com/tag/tiktoken/" class="article-tag">tiktoken</a>
                <a href="https://www.safjan.com/tag/prompt-chunking/" class="article-tag">prompt-chunking</a>
                <a href="https://www.safjan.com/tag/split-text/" class="article-tag">split-text</a>
                <a href="https://www.safjan.com/tag/text-partitioning/" class="article-tag">text-partitioning</a>
                <a href="https://www.safjan.com/tag/openai/" class="article-tag">openai</a>
                <a href="https://www.safjan.com/tag/gpt-4/" class="article-tag">gpt-4</a>
        </div>







            <div class="related-posts">
                <h4 class="related-posts-title">You might also like</h4>
                <div class="related-posts-grid">
                        <a href="https://www.safjan.com/how-to-count-tokens/" class="related-post-card">
                            <span class="related-post-title">How to Count Tokens - Tokenization With Tiktoken.</span>
                            <span class="related-post-date">Jun 08, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/punctuation-restoration/" class="related-post-card">
                            <span class="related-post-title">Punctuation Restoration</span>
                            <span class="related-post-date">Mar 15, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/script-to-python-package-using-poetry-and-pycharm/" class="related-post-card">
                            <span class="related-post-title">Script to Python Package Using Poetry (And PyCharm)</span>
                            <span class="related-post-date">Jun 28, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/split-glued-or-joined-words/" class="related-post-card">
                            <span class="related-post-title">Split glued or joined words</span>
                            <span class="related-post-date">Aug 12, 2023</span>
                        </a>
                </div>
            </div>




    </article>

    <footer>
<p>
  &copy; 2026 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>    </footer>
</main>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Krystian Safjan's Blog",
  "url": "https://www.safjan.com",
"image": "/images/profile_new.jpg",  "description": ""
}
</script>


<script src="/pagefind/pagefind-ui.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', function() {
        new PagefindUI({
            element: "#search",
            showSubResults: false,
            showImages: false,
            basePath: "/pagefind/"
        });
    });
</script>

<script src="https://www.safjan.com/theme/js/theme-switcher.js"></script>

<style>
.video-embed {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%;
    background: #000;
    border-radius: 0.375rem;
    overflow: hidden;
}
.video-embed iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
.video-embed-wrapper {
    margin-bottom: 1rem;
}
.video-embed-info {
    padding: 0.5rem 0.75rem;
    background: var(--color-bg-secondary, #f6f8fa);
    border-radius: 0 0 0.375rem 0.375rem;
    font-size: 0.875rem;
    margin-top: -0.375rem;
}
.video-embed-info a {
    text-decoration: none;
    color: inherit;
}
.video-embed-info a:hover {
    text-decoration: underline;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('pre > code').forEach(function(code) {
        var text = code.textContent.trim();
        var lines = text.split('\n');
        var url = lines[0].trim();

        var videoId = null;
        var embedUrl = null;
        var platform = null;

        // YouTube detection
        var ytMatch = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/);
        if (ytMatch) {
            videoId = ytMatch[1];
            embedUrl = 'https://www.youtube-nocookie.com/embed/' + videoId;
            platform = 'youtube';
        }

        // Vimeo detection
        var vimeoMatch = url.match(/vimeo\.com\/(?:video\/)?(\d+)/);
        if (vimeoMatch) {
            videoId = vimeoMatch[1];
            embedUrl = 'https://player.vimeo.com/video/' + videoId + '?dnt=1';
            platform = 'vimeo';
        }

        if (!videoId || !embedUrl) return;

        var meta = {};
        lines.slice(1).forEach(function(line) {
            var m = line.match(/^(\w+):\s*(.+)$/);
            if (m) meta[m[1].toLowerCase()] = m[2].trim();
        });

        var wrapper = document.createElement('div');
        wrapper.className = 'video-embed-wrapper';

        var embed = document.createElement('div');
        embed.className = 'video-embed';
        embed.innerHTML = '<iframe src="' + embedUrl +
            '" allowfullscreen loading="lazy" title="' + (meta.title || (platform === 'youtube' ? 'YouTube video' : 'Vimeo video')).replace(/"/g, '&quot;') + '"></iframe>';
        wrapper.appendChild(embed);

        if (meta.title || meta.author) {
            var info = document.createElement('div');
            info.className = 'video-embed-info';
            var html = meta.title ? '<strong>' + meta.title + '</strong>' : '';
            if (meta.author) {
                html += (meta.title ? ' &bull; ' : '');
                html += meta.authorurl ? '<a href="' + meta.authorurl + '" target="_blank" rel="noopener">' + meta.author + '</a>' : meta.author;
            }
            info.innerHTML = html;
            wrapper.appendChild(info);
        }
        code.closest('pre').replaceWith(wrapper);
    });
});
</script>

<style>
.tweet-embed-wrapper {
    margin-bottom: 1rem;
}
.tweet-embed-loading {
    padding: 1rem;
    background: var(--color-bg-secondary, #f6f8fa);
    border-radius: 0.375rem;
    color: var(--color-text-secondary, #6c757d);
    font-size: 0.875rem;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var twitterScriptLoaded = false;

    function loadTwitterScript() {
        if (twitterScriptLoaded) return;
        twitterScriptLoaded = true;
        var script = document.createElement('script');
        script.src = 'https://platform.twitter.com/widgets.js';
        script.async = true;
        document.body.appendChild(script);
    }

    document.querySelectorAll('pre > code.language-tweet').forEach(function(code) {
        var text = code.textContent.trim();
        var url = text.split('\n')[0].trim();

        // Twitter/X URL detection
        var tweetMatch = url.match(/^https?:\/\/(twitter\.com|x\.com)\/\w+\/status\/(\d+)/);
        if (!tweetMatch) return;

        var wrapper = document.createElement('div');
        wrapper.className = 'tweet-embed-wrapper';
        wrapper.innerHTML = '<div class="tweet-embed-loading">Loading tweet...</div>';

        code.closest('pre').replaceWith(wrapper);

        // Fetch oEmbed data
        var oembedUrl = 'https://publish.twitter.com/oembed?url=' + encodeURIComponent(url) + '&dnt=true&omit_script=true';

        fetch(oembedUrl)
            .then(function(response) { return response.json(); })
            .then(function(data) {
                wrapper.innerHTML = data.html;
                loadTwitterScript();
                if (window.twttr && window.twttr.widgets) {
                    window.twttr.widgets.load(wrapper);
                }
            })
            .catch(function() {
                wrapper.innerHTML = '<div class="tweet-embed-loading">Failed to load tweet. <a href="' + url + '" target="_blank" rel="noopener">View on Twitter</a></div>';
            });
    });
});
</script>
</body>
</html>