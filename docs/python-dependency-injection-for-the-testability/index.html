
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="color-scheme" content="light dark"/>
    <script>
      (function() {
        var theme = localStorage.getItem('theme-preference');
        if (theme === 'dark' || theme === 'light') {
          document.documentElement.setAttribute('data-theme', theme);
        }
      })();
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"/>
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap"
              rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/stylesheet/style.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/pygments/github.min.css">


    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/brands.css">
    <link rel="stylesheet" type="text/css" href="https://www.safjan.com/theme/font-awesome/css/solid.css">

    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">

        <link rel="stylesheet" type="text/css"
              href="https://www.safjan.com/styles/custom.css">

        <link href="https://www.safjan.com/feeds/all.atom.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/atom+xml" rel="alternate"
              title="Krystian Safjan's Blog Atom">

        <link href="https://www.safjan.com/feeds/all.rss.xml?utm_source=rss&utm_medium=feed&utm_campaign=rss-feed" type="application/rss+xml" rel="alternate"
              title="Krystian Safjan's Blog RSS">


    <link rel="apple-touch-icon" sizes="180x180" href="https://www.safjan.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.safjan.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.safjan.com/favicon-16x16.png">
    <link rel="shortcut icon" href="https://www.safjan.com/favicon.ico">
    <link rel="manifest" href="https://www.safjan.com/site.webmanifest">
    <meta name="theme-color" content="#333333">
    <meta name="apple-mobile-web-app-title" content="Krystian Safjan's Blog">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RM2PKDCCYM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-RM2PKDCCYM');
</script>
<!-- End of Google tag (gtag.js) -->



    <meta name="author" content="Krystian Safjan"/>
    <meta name="description" content="Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code."/>
    <meta name="keywords" content="machine-learning, python, testing, dependency-injection, software-development">


  <meta property="og:site_name" content="Krystian Safjan's Blog"/>
  <meta property="og:title" content="Harnessing the Power of Dependency Injection for Improved Testability in Python"/>
  <meta property="og:description" content="Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.safjan.com/python-dependency-injection-for-the-testability/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2023-06-21 00:00:00+02:00"/>
  <meta property="article:modified_time" content="2023-06-21 00:00:00+02:00"/>
  <meta property="article:author" content="https://www.safjan.com/author/krystian-safjan/"/>
  <meta property="article:section" content="Machine Learning"/>
  <meta property="article:tag" content="machine-learning"/>
  <meta property="article:tag" content="python"/>
  <meta property="article:tag" content="testing"/>
  <meta property="article:tag" content="dependency-injection"/>
  <meta property="article:tag" content="software-development"/>
  <meta property="og:image" content="https://www.safjan.com//images/head/dependency_injection_2_cr_640px.jpg"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://www.safjan.com//images/head/dependency_injection_2_cr_640px.jpg"/>
    <meta name="twitter:image:alt" content="Harnessing the Power of Dependency Injection for Improved Testability in Python"/>


    <meta name="twitter:site" content="@izikeros"/>
    <meta name="twitter:creator" content="@izikeros"/>
    <meta name="twitter:title" content="Harnessing the Power of Dependency Injection for Improved Testability in Python"/>
    <meta name="twitter:description" content="Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code."/>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.safjan.com/python-dependency-injection-for-the-testability/"
  },
  "headline": "Harnessing the Power of Dependency Injection for Improved Testability in Python",
  "datePublished": "2023-06-21T00:00:00+02:00",
  "dateModified": "2023-06-21T00:00:00+02:00",
  "author": {
    "@type": "Person",
    "name": "Krystian Safjan",
    "url": "https://www.safjan.com/author/krystian-safjan/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Krystian Safjan's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/profile_new.jpg"
    }  },
"image": "https://www.safjan.com//images/head/dependency_injection_2_cr_640px.jpg",  "url": "https://www.safjan.com/python-dependency-injection-for-the-testability/",
  "description": "Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code.",
  "articleSection": "Machine Learning",
  "inLanguage": "en",
  "keywords": "machine-learning, python, testing, dependency-injection, software-development",
  "wordCount": 841,
  "speakable": {
    "@type": "SpeakableSpecification",
    "cssSelector": ["article h1", ".summary", ".tldr", "article \u003e p:first-of-type"]
  }}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://www.safjan.com/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Machine Learning",
      "item": "https://www.safjan.com/category/machine-learning.html"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Harnessing the Power of Dependency Injection..."
    }
  ]
}
</script>



<meta name="ai:summary" content="Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code.">

<meta name="ai:topics" content="machine-learning, python, testing, dependency-injection, software-development">



<meta name="ai:word-count" content="841">
<meta name="ai:reading-time" content="4 min">

<meta name="ai:section" content="Machine Learning">



<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">

    <title>    Harnessing the Power of Dependency Injection for Improved Testability in Python
</title>



<!-- Google Automatic Ads -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9767732578835199"
     crossorigin="anonymous"></script>
<!-- End of Google Automatic Ads -->


</head>
<body>
<div id="reading-progress" class="reading-progress"></div>
<aside>
    <div>
        <a href="https://www.safjan.com/">
                <img src="/images/profile_new.jpg" alt="Krystian Safjan's Blog" title="Krystian Safjan's Blog" width="140" height="140">
        </a>

        <h1>
            <a href="https://www.safjan.com/">Krystian Safjan's Blog</a>
        </h1>

<p>Data Scientist and Team Leader writing about Machine Learning, MLOps, and Python</p>


        <ul class="social">
                <li>
                    <a  class="sc-linkedin" href="https://pl.linkedin.com/in/krystiansafjan"
                       target="_blank">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-github" href="https://github.com/izikeros"
                       target="_blank">
                        <i class="fab fa-github"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-envelope" href="mailto:ksafjan@gmail.com"
                       target="_blank">
                        <i class="fas fa-envelope"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-graduation-cap" href="https://scholar.google.pl/citations?user=UlNJgMoAAAAJ"
                       target="_blank">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </li>
                <li>
                    <a  class="sc-rss" href="/feeds/all.rss.xml"
                       target="_blank">
                        <i class="fas fa-rss"></i>
                    </a>
                </li>
        </ul>
    </div>

<div class="promo-box">
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-image">
        <img src="/images/mlop_interview_book_cover_3D_300px.jpg" alt="MLOps Interview Book Cover">
    </a>
    
    <p class="promo-box-headline">Ace Your MLOps Interview</p>
    
    <a href="https://ksafjanuser.gumroad.com/l/mlops" class="promo-box-cta">
        Get for $2.99
    </a>
    
    <p class="promo-box-features">50 Q&A â€¢ PDF/ePUB/mobi</p>
</div>
</aside>
<main>

        <nav aria-label="Main navigation">
            <a href="https://www.safjan.com/">Home</a>

                <a href="/archives.html">Articles</a>
                <a href="/til.html">Notes</a>
                <a href="/categories.html">Categories</a>
                <a href="/pdfs/Krystian_Safjan_resume_priv.pdf">Resume</a>

                <a href="https://www.safjan.com/feeds/all.atom.xml">Atom</a>

                <a href="https://www.safjan.com/feeds/all.rss.xml">RSS</a>

            <div id="search" class="nav-search"></div>
            <button type="button" id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <i class="fas fa-sun"></i>
                <i class="fas fa-moon"></i>
            </button>
        </nav>

    <article class="single">
        <header>
                
            <p>
                <!-- Posted on: -->
                2023-06-21 


                <br/>
            </p>
            <h1>Harnessing the Power of Dependency Injection for Improved Testability in Python</h1>
            <div class="header-underline"></div>
                <div class="summary"><p>Learn how to use dependency injection to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code.</p></div>

                <div style="width: 100%; padding-bottom: 30px; position: relative;">
                    <a href="https://www.safjan.com/python-dependency-injection-for-the-testability/">
                        <img style="width: 100%; "
                             src="/images/head/dependency_injection_2_cr_640px.jpg" alt="Harnessing the Power of Dependency Injection for Improved Testability in Python">
                    </a>
                </div>


        </header>




        <div class="article-content">
            <h2 id="introduction">Introduction</h2>
<p>In software development, testability is a crucial aspect that helps ensure the reliability and maintainability of our code. One effective technique for enhancing testability is dependency injection (DI). Dependency injection allows us to decouple dependencies from our functions, methods, or classes, making it easier to test and maintain our code. In this blog post, we will explore various techniques, use cases, and lesser-known tricks for using dependency injection in Python.</p>
<!-- MarkdownTOC levels="2,3" autolink="true" autoanchor="true" -->

<ul>
<li><a href="#what-is-dependency-injection">What is Dependency Injection?</a></li>
<li><a href="#benefits-of-dependency-injection">Benefits of Dependency Injection:</a></li>
<li><a href="#techniques-for-dependency-injection">Techniques for Dependency Injection</a></li>
<li><a href="#constructor-injection">Constructor Injection</a></li>
<li><a href="#setter-injection">Setter Injection</a></li>
<li><a href="#interface-injection">Interface Injection</a></li>
<li><a href="#use-cases-for-dependency-injection">Use Cases for Dependency Injection:</a></li>
<li><a href="#testing-legacy-code">Testing Legacy Code</a></li>
<li><a href="#mocking-dependencies">Mocking Dependencies</a></li>
<li><a href="#improving-code-reusability">Improving Code Reusability</a></li>
<li><a href="#parameter-injection">Parameter Injection:</a></li>
<li><a href="#context-managers-and-dependency-injection">Context Managers and Dependency Injection</a></li>
<li><a href="#dependency-injection-containers">Dependency Injection Containers</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<!-- /MarkdownTOC -->

<h2 id="what-is-dependency-injection">What is Dependency Injection?</h2>
<p>Dependency injection is a design pattern that allows us to inject dependencies into a class or function from external sources rather than creating them internally. By doing so, we reduce the coupling between components and make them more flexible, reusable, and testable.</p>
<h2 id="benefits-of-dependency-injection">Benefits of Dependency Injection</h2>
<ul>
<li><strong>Improved testability</strong>: By injecting dependencies, we can easily replace them with mocks or stubs during testing, making our tests more isolated and focused.</li>
<li><strong>Decoupled code</strong>: Dependency injection reduces the tight coupling between components, promoting better separation of concerns and modular design.</li>
<li><strong>Code reusability</strong>: With dependency injection, components become more reusable as they rely on abstractions rather than concrete implementations.</li>
<li><strong>Easier maintenance</strong>: By externalizing dependencies, we can modify or extend their behavior without affecting the code that uses them.</li>
</ul>
<h2 id="techniques-for-dependency-injection">Techniques for Dependency Injection</h2>
<h3 id="constructor-injection">Constructor Injection</h3>
<p>Constructor injection involves passing dependencies through a class's constructor. It ensures that the required dependencies are available before an object is created.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_repository</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">user_repository</span>

    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
</code></pre></div>

<h3 id="setter-injection">Setter Injection</h3>
<p>Setter injection involves setting the dependencies using setter methods. This technique allows for more flexibility, as dependencies can be changed or updated after object initialization.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">NotificationService</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">set_email_service</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">email_service</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email_service</span> <span class="o">=</span> <span class="n">email_service</span>

    <span class="k">def</span> <span class="nf">send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">email_service</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="s2">&quot;New notification!&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="interface-injection">Interface Injection</h3>
<p>Interface injection is a technique where a dependency is injected by providing an interface or an abstract base class. This allows for the injection of different implementations of the same interface, providing flexibility and extensibility.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>

<span class="k">class</span> <span class="nc">Database</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">MySQLDatabase</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="c1"># Perform MySQL query</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">PostgresDatabase</span><span class="p">(</span><span class="n">Database</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="c1"># Perform Postgres query</span>
        <span class="k">pass</span>
</code></pre></div>

<h2 id="use-cases-for-dependency-injection">Use Cases for Dependency Injection</h2>
<h3 id="testing-legacy-code">Testing Legacy Code</h3>
<p>When working with legacy code that has tightly coupled dependencies, dependency injection can be used to introduce testability by replacing or mocking those dependencies during testing.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">legacy_function</span><span class="p">():</span>
    <span class="c1"># ...</span>
    <span class="n">db_connection</span> <span class="o">=</span> <span class="n">MySQLDatabase</span><span class="p">()</span>  <span class="c1"># Tightly coupled dependency</span>
    <span class="c1"># ...</span>

<span class="c1"># Using dependency injection to test legacy_function</span>


<span class="k">def</span> <span class="nf">test_legacy_function</span><span class="p">():</span>
    <span class="n">mock_db</span> <span class="o">=</span> <span class="n">MockMySQLDatabase</span><span class="p">()</span>
    <span class="n">legacy_function</span><span class="o">.</span><span class="n">inject_dependencies</span><span class="p">(</span><span class="n">db_connection</span><span class="o">=</span><span class="n">mock_db</span><span class="p">)</span>
    <span class="c1"># Test the function</span>
</code></pre></div>

<h3 id="mocking-dependencies">Mocking Dependencies</h3>
<p>In unit testing, dependency injection allows us to replace real dependencies with mock objects, enabling us to focus on testing the behavior of the unit under test in isolation.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">UserService</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_repository</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">user_repository</span>

    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

<span class="c1"># Testing UserService with a mock user repository</span>
<span class="k">def</span> <span class="nf">test_get_user</span><span class="p">():</span>
    <span class="n">mock_repository</span> <span class="o">=</span> <span class="n">MockUserRepository</span><span class="p">()</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">UserService</span><span class="p">(</span><span class="n">user_repository</span><span class="o">=</span><span class="n">mock_repository</span><span class="p">)</span>
    <span class="c1"># Test the method using the mock repository</span>
</code></pre></div>

<h3 id="improving-code-reusability">Improving Code Reusability</h3>
<p>Dependency injection promotes code reusability by relying on abstractions rather than concrete implementations. This allows different implementations to be injected based on specific requirements.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PaymentGateway</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">PayPalGateway</span><span class="p">(</span><span class="n">PaymentGateway</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="c1"># Process payment via PayPal</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">StripeGateway</span><span class="p">(</span><span class="n">PaymentGateway</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">process_payment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="c1"># Process payment via Stripe</span>
        <span class="k">pass</span>
</code></pre></div>

<ol>
<li>Lesser-Known Techniques and Tricks:</li>
</ol>
<h3 id="parameter-injection">Parameter Injection</h3>
<p>In addition to constructor, setter, and interface injection, parameter injection is a technique where dependencies are passed directly as parameters to functions or methods. This can be useful in situations where direct injection is preferred over using class instances.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">logger</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Processing data...&quot;</span><span class="p">)</span>
    <span class="c1"># Process the data</span>

<span class="c1"># Calling the function with injected dependencies</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">()</span>
<span class="n">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">logger</span><span class="p">)</span>
</code></pre></div>

<h3 id="context-managers-and-dependency-injection">Context Managers and Dependency Injection</h3>
<p>Context managers can be combined with dependency injection to provide resources or dependencies within a specific scope, ensuring their proper initialization and cleanup.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">db_connection</span><span class="p">():</span>
    <span class="n">connection</span> <span class="o">=</span> <span class="n">MySQLDatabase</span><span class="p">()</span>  <span class="c1"># Dependency initialization</span>
    <span class="k">yield</span> <span class="n">connection</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Cleanup</span>

<span class="c1"># Using the context manager with dependency injection</span>
<span class="k">with</span> <span class="n">db_connection</span><span class="p">()</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
    <span class="c1"># Use the database connection within the context</span>
</code></pre></div>

<h3 id="dependency-injection-containers">Dependency Injection Containers</h3>
<p>Dependency injection containers or frameworks provide a centralized way to manage dependencies, their configurations, and their lifetime. Popular Python DI frameworks include <code>injector</code>, <code>DInjector</code>, and <code>inject</code>.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">injector</span> <span class="kn">import</span> <span class="n">inject</span><span class="p">,</span> <span class="n">Injector</span>

<span class="k">class</span> <span class="nc">UserService</span><span class="p">:</span>
    <span class="nd">@inject</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_repository</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_repository</span> <span class="o">=</span> <span class="n">user_repository</span>

<span class="c1"># Creating and using an injector</span>
<span class="n">injector</span> <span class="o">=</span> <span class="n">Injector</span><span class="p">()</span>
<span class="n">user_service</span> <span class="o">=</span> <span class="n">injector</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">UserService</span><span class="p">)</span>
</code></pre></div>

<h2 id="conclusion">Conclusion</h2>
<p>Dependency injection is a powerful technique for improving testability, code modularity, and reusability in Python. By applying various injection techniques and exploring different use cases, you can design more robust and maintainable code. Additionally, the lesser-known tricks and techniques covered in this blog post can further enhance your understanding and application of dependency injection in various scenarios.</p>
<p><em>Any comments or suggestions? <a href="mailto:ksafjan@gmail.com?subject=Blog+post">Let me know</a>.</em></p>
        </div>




            <div class="bibtex-note">
                <p><b>To cite this article:</b></p>
                <pre>@article{Saf2023Harnessing,
    author  = {Krystian Safjan},
    title   = {Harnessing the Power of Dependency Injection for Improved Testability in Python},
    journal = {Krystian's Safjan Blog},
    year    = {2023},
}</pre>
            </div>
        <div class="article-tags">
            <span class="tags-label">Tags:</span>
                <a href="https://www.safjan.com/tag/machine-learning/" class="article-tag">machine-learning</a>
                <a href="https://www.safjan.com/tag/python/" class="article-tag">python</a>
                <a href="https://www.safjan.com/tag/testing/" class="article-tag">testing</a>
                <a href="https://www.safjan.com/tag/dependency-injection/" class="article-tag">dependency-injection</a>
                <a href="https://www.safjan.com/tag/software-development/" class="article-tag">software-development</a>
        </div>







            <div class="related-posts">
                <h4 class="related-posts-title">You might also like</h4>
                <div class="related-posts-grid">
                        <a href="https://www.safjan.com/the-role-and-responsibilities-of-a-forward-deployed-engineer/" class="related-post-card">
                            <span class="related-post-title">The Role and Responsibilities of a Forward Deployed Engineer - Bridging the Gap Between Software Products and Customer Needs</span>
                            <span class="related-post-date">Jun 09, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/implementing-sentence-boundary-detection-in-python-for-improved-text-chunkin/" class="related-post-card">
                            <span class="related-post-title">Implementing Sentence Boundary Detection in Python for Improved Text Chunking</span>
                            <span class="related-post-date">Aug 30, 2024</span>
                        </a>
                        <a href="https://www.safjan.com/techniques-to-boost-rag-performance-in-production/" class="related-post-card">
                            <span class="related-post-title">Techniques to Boost RAG Performance in Production</span>
                            <span class="related-post-date">Nov 01, 2023</span>
                        </a>
                        <a href="https://www.safjan.com/problems-with-Langchain-and-how-to-minimize-their-impact/" class="related-post-card">
                            <span class="related-post-title">Problems with Langchain and how to minimize their impact</span>
                            <span class="related-post-date">Sep 01, 2023</span>
                        </a>
                </div>
            </div>




    </article>

    <footer>
<p>
  &copy; 2026 Krystian Safjan - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>    </footer>
</main>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Krystian Safjan's Blog",
  "url": "https://www.safjan.com",
"image": "/images/profile_new.jpg",  "description": ""
}
</script>


<script src="/pagefind/pagefind-ui.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', function() {
        new PagefindUI({
            element: "#search",
            showSubResults: false,
            showImages: false,
            basePath: "/pagefind/"
        });
    });
</script>

<script src="https://www.safjan.com/theme/js/theme-switcher.js"></script>

<style>
.video-embed {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%;
    background: #000;
    border-radius: 0.375rem;
    overflow: hidden;
}
.video-embed iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
.video-embed-wrapper {
    margin-bottom: 1rem;
}
.video-embed-info {
    padding: 0.5rem 0.75rem;
    background: var(--color-bg-secondary, #f6f8fa);
    border-radius: 0 0 0.375rem 0.375rem;
    font-size: 0.875rem;
    margin-top: -0.375rem;
}
.video-embed-info a {
    text-decoration: none;
    color: inherit;
}
.video-embed-info a:hover {
    text-decoration: underline;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('pre > code').forEach(function(code) {
        var text = code.textContent.trim();
        var lines = text.split('\n');
        var url = lines[0].trim();

        var videoId = null;
        var embedUrl = null;
        var platform = null;

        // YouTube detection
        var ytMatch = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/);
        if (ytMatch) {
            videoId = ytMatch[1];
            embedUrl = 'https://www.youtube-nocookie.com/embed/' + videoId;
            platform = 'youtube';
        }

        // Vimeo detection
        var vimeoMatch = url.match(/vimeo\.com\/(?:video\/)?(\d+)/);
        if (vimeoMatch) {
            videoId = vimeoMatch[1];
            embedUrl = 'https://player.vimeo.com/video/' + videoId + '?dnt=1';
            platform = 'vimeo';
        }

        if (!videoId || !embedUrl) return;

        var meta = {};
        lines.slice(1).forEach(function(line) {
            var m = line.match(/^(\w+):\s*(.+)$/);
            if (m) meta[m[1].toLowerCase()] = m[2].trim();
        });

        var wrapper = document.createElement('div');
        wrapper.className = 'video-embed-wrapper';

        var embed = document.createElement('div');
        embed.className = 'video-embed';
        embed.innerHTML = '<iframe src="' + embedUrl +
            '" allowfullscreen loading="lazy" title="' + (meta.title || (platform === 'youtube' ? 'YouTube video' : 'Vimeo video')).replace(/"/g, '&quot;') + '"></iframe>';
        wrapper.appendChild(embed);

        if (meta.title || meta.author) {
            var info = document.createElement('div');
            info.className = 'video-embed-info';
            var html = meta.title ? '<strong>' + meta.title + '</strong>' : '';
            if (meta.author) {
                html += (meta.title ? ' &bull; ' : '');
                html += meta.authorurl ? '<a href="' + meta.authorurl + '" target="_blank" rel="noopener">' + meta.author + '</a>' : meta.author;
            }
            info.innerHTML = html;
            wrapper.appendChild(info);
        }
        code.closest('pre').replaceWith(wrapper);
    });
});
</script>

<style>
.tweet-embed-wrapper {
    margin-bottom: 1rem;
}
.tweet-embed-loading {
    padding: 1rem;
    background: var(--color-bg-secondary, #f6f8fa);
    border-radius: 0.375rem;
    color: var(--color-text-secondary, #6c757d);
    font-size: 0.875rem;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var twitterScriptLoaded = false;

    function loadTwitterScript() {
        if (twitterScriptLoaded) return;
        twitterScriptLoaded = true;
        var script = document.createElement('script');
        script.src = 'https://platform.twitter.com/widgets.js';
        script.async = true;
        document.body.appendChild(script);
    }

    document.querySelectorAll('pre > code.language-tweet').forEach(function(code) {
        var text = code.textContent.trim();
        var url = text.split('\n')[0].trim();

        // Twitter/X URL detection
        var tweetMatch = url.match(/^https?:\/\/(twitter\.com|x\.com)\/\w+\/status\/(\d+)/);
        if (!tweetMatch) return;

        var wrapper = document.createElement('div');
        wrapper.className = 'tweet-embed-wrapper';
        wrapper.innerHTML = '<div class="tweet-embed-loading">Loading tweet...</div>';

        code.closest('pre').replaceWith(wrapper);

        // Fetch oEmbed data
        var oembedUrl = 'https://publish.twitter.com/oembed?url=' + encodeURIComponent(url) + '&dnt=true&omit_script=true';

        fetch(oembedUrl)
            .then(function(response) { return response.json(); })
            .then(function(data) {
                wrapper.innerHTML = data.html;
                loadTwitterScript();
                if (window.twttr && window.twttr.widgets) {
                    window.twttr.widgets.load(wrapper);
                }
            })
            .catch(function() {
                wrapper.innerHTML = '<div class="tweet-embed-loading">Failed to load tweet. <a href="' + url + '" target="_blank" rel="noopener">View on Twitter</a></div>';
            });
    });
});
</script>
</body>
</html>